import{s as te,e as b,c as w,b as V,r as R,f as M,o as y,i as G,h as f,n as j,F as se,I as $,a as H,t as oe,z as ce,g as A,d as de,L as ve,K as Q,B as Y,j as fe,N as ue,k as me}from"../chunks/scheduler.e43ee5f3.js";import{S as ne,i as le,c as k,b as z,m as F,t as B,a as Z,d as K}from"../chunks/index.9c613d38.js";import{p as he}from"../chunks/stores.71509ca9.js";import{r as _e,s as pe}from"../chunks/utils.a5495163.js";function ge(l){let n,t,u='<div class="emogi svelte-6xd3vs">👾</div> <div class="emogi svelte-6xd3vs">💎</div> <div class="emogi svelte-6xd3vs">💰</div> <div class="emogi svelte-6xd3vs">🍒</div> <div class="emogi svelte-6xd3vs">🍊</div> <div class="emogi svelte-6xd3vs">🍋</div> <div class="emogi svelte-6xd3vs">🍉</div> <div class="emogi svelte-6xd3vs">🍌</div> <div class="emogi svelte-6xd3vs">🍆</div>';return{c(){n=b("div"),t=b("div"),t.innerHTML=u,this.h()},l(c){n=w(c,"DIV",{class:!0});var e=V(n);t=w(e,"DIV",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-1iz3z07"&&(t.innerHTML=u),e.forEach(M),this.h()},h(){y(t,"class","reel svelte-6xd3vs"),y(n,"class","container svelte-6xd3vs")},m(c,e){G(c,n,e),f(n,t),l[3](t)},p:j,i:j,o:j,d(c){c&&M(n),l[3](null)}}}function ye(l,n,t){let{spinOffset:u=0}=n,c=4e3+u*1e3,e;se(()=>{m()});const m=()=>{let s=e.querySelectorAll("div"),a=360/s.length,i=Math.round(s[0].offsetHeight/2/Math.tan(Math.PI/s.length));s.forEach((T,d)=>{let E=a*d;T.style.transform=`rotateX(${E}deg) translateZ(${i}px)`})},h=()=>{let s=e.querySelectorAll("div"),a=360/s.length,i=Math.round(s[0].offsetHeight/2/Math.tan(Math.PI/s.length)),T=_e(0,s.length-1),E=5+u;return new Promise((_,O)=>{t(0,e.style.transition=`all ${c}ms cubic-bezier(.41,-0.01,.63,1.09)`,e);let p=E*360+T*a;t(0,e.style.transform=`translateZ(${-i}px) rotateX(${-p}deg)`,e),setTimeout(()=>{t(0,e.style.transition="none",e),p=p%360,t(0,e.style.transform=`translateZ(${-i}px) rotateX(${-p}deg)`,e),_(T)},c)})};function I(s){$[s?"unshift":"push"](()=>{e=s,t(0,e)})}return l.$$set=s=>{"spinOffset"in s&&t(1,u=s.spinOffset)},[e,u,h,I]}class W extends ne{constructor(n){super(),le(this,n,ye,ge,te,{spinOffset:1,roll:2})}get roll(){return this.$$.ctx[2]}}function Ie(l){let n,t="",u,c,e,m,h,I,s,a,i,T,d,E,_,O,p,r,v,C='<div class="arm svelte-f4t2va"></div> <div class="ball svelte-f4t2va"></div>',D,x,L='<div class="instructions svelte-f4t2va">Type !slots to spin the wheel</div>',P,U,J,re={};i=new W({props:re}),l[7](i);let ae={spinOffset:1};d=new W({props:ae}),l[8](d);let ie={spinOffset:2};return _=new W({props:ie}),l[9](_),{c(){n=b("script"),n.innerHTML=t,c=H(),e=b("div"),m=b("div"),h=b("div"),I=oe(l[4]),s=H(),a=b("div"),k(i.$$.fragment),T=H(),k(d.$$.fragment),E=H(),k(_.$$.fragment),O=H(),p=b("div"),r=H(),v=b("div"),v.innerHTML=C,D=H(),x=b("div"),x.innerHTML=L,this.h()},l(o){const N=ce("svelte-1nbh741",document.head);n=w(N,"SCRIPT",{src:!0,"data-svelte-h":!0}),R(n)!=="svelte-i7ndq0"&&(n.innerHTML=t),N.forEach(M),c=A(o),e=w(o,"DIV",{class:!0});var g=V(e);m=w(g,"DIV",{class:!0});var q=V(m);h=w(q,"DIV",{class:!0});var X=V(h);I=de(X,l[4]),X.forEach(M),q.forEach(M),s=A(g),a=w(g,"DIV",{class:!0});var S=V(a);z(i.$$.fragment,S),T=A(S),z(d.$$.fragment,S),E=A(S),z(_.$$.fragment,S),S.forEach(M),O=A(g),p=w(g,"DIV",{class:!0}),V(p).forEach(M),r=A(g),v=w(g,"DIV",{class:!0,role:!0,tabindex:!0,"data-svelte-h":!0}),R(v)!=="svelte-1chcmit"&&(v.innerHTML=C),D=A(g),x=w(g,"DIV",{class:!0,"data-svelte-h":!0}),R(x)!=="svelte-1ugn8wi"&&(x.innerHTML=L),g.forEach(M),this.h()},h(){ve(n.src,u="/tarot/tmi.min.js")||y(n,"src",u),y(h,"class","name svelte-f4t2va"),y(m,"class","semi-circle svelte-f4t2va"),y(a,"class","slots svelte-f4t2va"),Q(a,"winner",l[5]),y(p,"class","mount svelte-f4t2va"),y(v,"class","lever svelte-f4t2va"),y(v,"role","button"),y(v,"tabindex","0"),y(x,"class","console svelte-f4t2va"),y(e,"class","container svelte-f4t2va")},m(o,N){f(document.head,n),G(o,c,N),G(o,e,N),f(e,m),f(m,h),f(h,I),f(e,s),f(e,a),F(i,a,null),f(a,T),F(d,a,null),f(a,E),F(_,a,null),f(e,O),f(e,p),f(e,r),f(e,v),l[10](v),f(e,D),f(e,x),P=!0,U||(J=[Y(v,"click",l[6]),Y(v,"keypress",l[6])],U=!0)},p(o,[N]){(!P||N&16)&&fe(I,o[4]);const g={};i.$set(g);const q={};d.$set(q);const X={};_.$set(X),(!P||N&32)&&Q(a,"winner",o[5])},i(o){P||(B(i.$$.fragment,o),B(d.$$.fragment,o),B(_.$$.fragment,o),P=!0)},o(o){Z(i.$$.fragment,o),Z(d.$$.fragment,o),Z(_.$$.fragment,o),P=!1},d(o){o&&(M(c),M(e)),M(n),l[7](null),K(i),l[8](null),K(d),l[9](null),K(_),l[10](null),U=!1,ue(J)}}}const ee="hello-world",Me=2e3;function Te(l,n,t){let u;me(l,he,r=>t(12,u=r));let c,e,m,h,I,s=[],a=ee,i=!1;se(async()=>{c=u.url.searchParams.get("username"),T()});const T=()=>{const r=new window.tmi.Client({channels:[c]});r.connect(),r.on("message",(v,C,D,x)=>{let L=C["display-name"];console.log(`${L}: ${D}`),D=="!slots"&&(s.length==0?(s.push(L),d()):s.push(L))})},d=async()=>{const r=[{transform:"rotateX(0)"},{transform:"rotateX(180deg)"},{transform:"rotateX(0)"}],v={duration:2e3,easing:"ease-out"};I.animate(r,v),t(4,a=s[0]),a==null&&t(4,a=ee),(await Promise.all([e.roll(),m.roll(),h.roll()])).every((D,x,L)=>D===L[0])&&(t(5,i=!0),await pe(Me),t(5,i=!1)),s.shift(),s.length>0&&d()};function E(r){$[r?"unshift":"push"](()=>{e=r,t(0,e)})}function _(r){$[r?"unshift":"push"](()=>{m=r,t(1,m)})}function O(r){$[r?"unshift":"push"](()=>{h=r,t(2,h)})}function p(r){$[r?"unshift":"push"](()=>{I=r,t(3,I)})}return[e,m,h,I,a,i,d,E,_,O,p]}class De extends ne{constructor(n){super(),le(this,n,Te,Ie,te,{})}}export{De as component};
