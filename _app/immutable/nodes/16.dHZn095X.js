import{a7 as bo,a8 as _o,Z as Bn,V as wo,s as Ot,e as ce,c as le,q as G,O as ui,i as ve,n as Ie,f as W,J as on,K as ko,G as Qe,k as Nt,a as De,t as je,b as me,g as Ae,d as Te,h as $,E as Le,o as xo,j as _t,r as an,A as si,B as ci,x as un,D as Ft,Q as Ki,a9 as qn,F as Di,aa as Ai,C as Po}from"../chunks/scheduler.CHusSsjn.js";import{g as Mt,t as Re,e as Ut,a as xe,S as Et,i as St,c as wt,b as kt,m as xt,d as Pt}from"../chunks/index.D6p7BjwM.js";import{e as ct,u as Ii,o as ji}from"../chunks/each.BDPIrIF-.js";import{t as Oo}from"../chunks/Toaster.svelte_svelte_type_style_lang.CqBmKxB4.js";import{d as Or,w as Ti}from"../chunks/index.6ms4aPJv.js";import{c as li,g as Eo}from"../chunks/_commonjsHelpers.Cpj98o6Y.js";function fi(d,a){const l=a.token={};function s(k,w,O,x){if(a.token!==l)return;a.resolved=x;let E=a.ctx;O!==void 0&&(E=E.slice(),E[O]=x);const D=k&&(a.current=k)(E);let T=!1;a.block&&(a.blocks?a.blocks.forEach((M,oe)=>{oe!==w&&M&&(Mt(),Re(M,1,1,()=>{a.blocks[oe]===M&&(a.blocks[oe]=null)}),Ut())}):a.block.d(1),D.c(),xe(D,1),D.m(a.mount(),a.anchor),T=!0),a.block=D,a.blocks&&(a.blocks[w]=D),T&&wo()}if(bo(d)){const k=_o();if(d.then(w=>{Bn(k),s(a.then,1,a.value,w),Bn(null)},w=>{if(Bn(k),s(a.catch,2,a.error,w),Bn(null),!a.hasCatch)throw w}),a.current!==a.pending)return s(a.pending,0),!0}else{if(a.current!==a.then)return s(a.then,1,a.value,d),!0;a.resolved=d}}function So(d,a,l){const s=a.slice(),{resolved:k}=d;d.current===d.then&&(s[d.value]=k),d.current===d.catch&&(s[d.error]=k),d.block.p(s,l)}function Co(d){let a,l,s;return{c(){a=ce("img"),this.h()},l(k){a=le(k,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){G(a,"class","w-32 h-32"),ui(a.src,l=d[1])||G(a,"src",l),G(a,"alt",s="Lazy Loaded Image "+d[0])},m(k,w){ve(k,a,w),d[4](a)},p(k,[w]){w&2&&!ui(a.src,l=k[1])&&G(a,"src",l),w&1&&s!==(s="Lazy Loaded Image "+k[0])&&G(a,"alt",s)},i:Ie,o:Ie,d(k){k&&W(a),d[4](null)}}}function Ko(d,a,l){let{src:s}=a,{name:k}=a,w="",O,x;on(()=>{O=new IntersectionObserver(D=>{D.forEach(T=>{T.isIntersecting&&(l(1,w=s),O.disconnect())})}),O.observe(x)});function E(D){ko[D?"unshift":"push"](()=>{x=D,l(2,x)})}return d.$$set=D=>{"src"in D&&l(3,s=D.src),"name"in D&&l(0,k=D.name)},[k,w,x,s,E]}class Do extends Et{constructor(a){super(),St(this,a,Ko,Co,Ot,{src:3,name:0})}}var Ri={exports:{}};(function(d,a){(function(l,s){d.exports=s()})(li,function(){var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])})(e,t)},s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function k(e,t,n){for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||((r=r||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var w=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:li,O=Object.keys,x=Array.isArray;function E(e,t){return typeof t!="object"||O(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||w.Promise||(w.Promise=Promise);var D=Object.getPrototypeOf,T={}.hasOwnProperty;function M(e,t){return T.call(e,t)}function oe(e,t){typeof t=="function"&&(t=t(D(e))),(typeof Reflect>"u"?O:Reflect.ownKeys)(t).forEach(function(n){X(e,n,t[n])})}var ue=Object.defineProperty;function X(e,t,n,r){ue(e,t,E(n&&M(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function ye(e){return{from:function(t){return e.prototype=Object.create(t.prototype),X(e.prototype,"constructor",e),{extend:oe.bind(null,e.prototype)}}}}var we=Object.getOwnPropertyDescriptor,ke=[].slice;function fe(e,t,n){return ke.call(e,t,n)}function Z(e,t){return t(e)}function V(e){if(!e)throw new Error("Assertion Failed")}function q(e){w.setImmediate?setImmediate(e):setTimeout(e,0)}function Y(e,t){if(typeof t=="string"&&M(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var o=Y(e,t[r]);n.push(o)}return n}var u=t.indexOf(".");if(u!==-1){var c=e[t.substr(0,u)];return c==null?void 0:Y(c,t.substr(u+1))}}function z(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){V(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)z(e,t[r],n[r])}else{var o,u,c=t.indexOf(".");c!==-1?(o=t.substr(0,c),(u=t.substr(c+1))===""?n===void 0?x(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n:z(c=!(c=e[o])||!M(e,o)?e[o]={}:c,u,n)):n===void 0?x(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function ae(e){var t,n={};for(t in e)M(e,t)&&(n[t]=e[t]);return n}var te=[].concat;function Pe(e){return te.apply([],e)}var Je="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Pe([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return w[e]}),Se=new Set(Je.map(function(e){return w[e]})),he=null;function ge(e){return he=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var r=he.get(n);if(r)return r;if(x(n)){r=[],he.set(n,r);for(var i=0,o=n.length;i<o;++i)r.push(t(n[i]))}else if(Se.has(n.constructor))r=n;else{var u,c=D(n);for(u in r=c===Object.prototype?{}:Object.create(c),he.set(n,r),n)M(n,u)&&(r[u]=t(n[u]))}return r}(e),he=null,e}var Ye={}.toString;function Me(e){return Ye.call(e).slice(8,-1)}var Be=typeof Symbol<"u"?Symbol.iterator:"@@iterator",tt=typeof Be=="symbol"?function(e){var t;return e!=null&&(t=e[Be])&&t.apply(e)}:function(){return null};function We(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var Ct={};function Xe(e){var t,n,r,i;if(arguments.length===1){if(x(e))return e.slice();if(this===Ct&&typeof e=="string")return[e];if(i=tt(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Fn=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Yt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ue=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Yt),Mi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Kt(e,t){this.name=e,this.message=t}function Er(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function sn(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Er(e,t)}function Dt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Er(e,this.failures)}ye(Kt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ye(sn).from(Kt),ye(Dt).from(Kt);var Mn=Ue.reduce(function(e,t){return e[t]=t+"Error",e},{}),Ui=Kt,L=Ue.reduce(function(e,t){var n=t+"Error";function r(i,o){this.name=n,i?typeof i=="string"?(this.message="".concat(i).concat(o?`
 `+o:""),this.inner=o||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=Mi[t]||n,this.inner=null)}return ye(r).from(Ui),e[t]=r,e},{});L.Syntax=SyntaxError,L.Type=TypeError,L.Range=RangeError;var Sr=Yt.reduce(function(e,t){return e[t+"Error"]=L[t],e},{}),cn=Ue.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=L[t]),e},{});function se(){}function Vt(e){return e}function Li(e,t){return e==null||e===Vt?t:function(n){return t(e(n))}}function ft(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Vi(e,t){return e===se?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ft(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ft(i,this.onerror):i),o!==void 0?o:n}}function zi(e,t){return e===se?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ft(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ft(r,this.onerror):r)}}function Yi(e,t){return e===se?t:function(n){var r=e.apply(this,arguments);E(n,r);var i=this.onsuccess,o=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?ft(i,this.onsuccess):i),o&&(this.onerror=this.onerror?ft(o,this.onerror):o),r===void 0?n===void 0?void 0:n:E(r,n)}}function Wi(e,t){return e===se?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Un(e,t){return e===se?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}cn.ModifyError=sn,cn.DexieError=Kt,cn.BulkError=Dt;var $e=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Cr(e){$e=e}var zt={},Kr=100,Je=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,D(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,D(t),e]}(),Yt=Je[0],Ue=Je[1],Je=Je[2],Ue=Ue&&Ue.then,Wt=Yt&&Yt.constructor,Ln=!!Je,$t=function(e,t){Ht.push([e,t]),ln&&(queueMicrotask(Hi),ln=!1)},Vn=!0,ln=!0,ht=[],fn=[],zn=Vt,nt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:se,pgp:!1,env:{},finalize:se},U=nt,Ht=[],dt=0,hn=[];function F(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=U;if(typeof e!="function"){if(e!==zt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Wn(this,this._value))}this._state=null,this._value=null,++t.ref,function n(r,i){try{i(function(o){if(r._state===null){if(o===r)throw new TypeError("A promise cannot be resolved with itself.");var u=r._lib&&At();o&&typeof o.then=="function"?n(r,function(c,m){o instanceof F?o._then(c,m):o.then(c,m)}):(r._state=!0,r._value=o,Ar(r)),u&&It()}},Wn.bind(null,r))}catch(o){Wn(r,o)}}(this,e)}var Yn={get:function(){var e=U,t=yn;function n(r,i){var o=this,u=!e.global&&(e!==U||t!==yn),c=u&&!it(),m=new F(function(h,g){$n(o,new Dr(jr(r,e,u,c),jr(i,e,u,c),h,g,e))});return this._consoleTask&&(m._consoleTask=this._consoleTask),m}return n.prototype=zt,n},set:function(e){X(this,"then",e&&e.prototype===zt?Yn:{get:function(){return e},set:Yn.set})}};function Dr(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}function Wn(e,t){var n,r;fn.push(t),e._state===null&&(n=e._lib&&At(),t=zn(t),e._state=!1,e._value=t,r=e,ht.some(function(i){return i._value===r._value})||ht.push(r),Ar(e),n&&It())}function Ar(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)$n(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),dt===0&&(++dt,$t(function(){--dt==0&&Hn()},[]))}function $n(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++dt,$t($i,[n,e,t])}else e._listeners.push(t)}function $i(e,t,n){try{var r,i=t._value;!t._state&&fn.length&&(fn=[]),r=$e&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),t._state||fn.indexOf(i)!==-1||function(o){for(var u=ht.length;u;)if(ht[--u]._value===o._value)return ht.splice(u,1)}(t),n.resolve(r)}catch(o){n.reject(o)}finally{--dt==0&&Hn(),--n.psd.ref||n.psd.finalize()}}function Hi(){pt(nt,function(){At()&&It()})}function At(){var e=Vn;return ln=Vn=!1,e}function It(){var e,t,n;do for(;0<Ht.length;)for(e=Ht,Ht=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<Ht.length);ln=Vn=!0}function Hn(){var e=ht;ht=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=hn.slice(0),n=t.length;n;)t[--n]()}function dn(e){return new F(zt,!1,e)}function pe(e,t){var n=U;return function(){var r=At(),i=U;try{return ot(n,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{ot(i,!1),r&&It()}}}oe(F.prototype,{then:Yn,_then:function(e,t){$n(this,new Dr(null,null,e,t,U))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:dn)(r)}):this.then(null,function(r){return(r&&r.name===t?n:dn)(r)})},finally:function(e){return this.then(function(t){return F.resolve(e()).then(function(){return t})},function(t){return F.resolve(e()).then(function(){return dn(t)})})},timeout:function(e,t){var n=this;return e<1/0?new F(function(r,i){var o=setTimeout(function(){return i(new L.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&X(F.prototype,Symbol.toStringTag,"Dexie.Promise"),nt.env=Ir(),oe(F,{all:function(){var e=Xe.apply(null,arguments).map(vn);return new F(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,o){return F.resolve(i).then(function(u){e[o]=u,--r||t(e)},n)})})},resolve:function(e){return e instanceof F?e:e&&typeof e.then=="function"?new F(function(t,n){e.then(t,n)}):new F(zt,!0,e)},reject:dn,race:function(){var e=Xe.apply(null,arguments).map(vn);return new F(function(t,n){e.map(function(r){return F.resolve(r).then(t,n)})})},PSD:{get:function(){return U},set:function(e){return U=e}},totalEchoes:{get:function(){return yn}},newPSD:rt,usePSD:pt,scheduler:{get:function(){return $t},set:function(e){$t=e}},rejectionMapper:{get:function(){return zn},set:function(e){zn=e}},follow:function(e,t){return new F(function(n,r){return rt(function(i,o){var u=U;u.unhandleds=[],u.onunhandled=o,u.finalize=ft(function(){var c,m=this;c=function(){m.unhandleds.length===0?i():o(m.unhandleds[0])},hn.push(function h(){c(),hn.splice(hn.indexOf(h),1)}),++dt,$t(function(){--dt==0&&Hn()},[])},u.finalize),e()},t,n,r)})}}),Wt&&(Wt.allSettled&&X(F,"allSettled",function(){var e=Xe.apply(null,arguments).map(vn);return new F(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,o){return F.resolve(i).then(function(u){return r[o]={status:"fulfilled",value:u}},function(u){return r[o]={status:"rejected",reason:u}}).then(function(){return--n||t(r)})})})}),Wt.any&&typeof AggregateError<"u"&&X(F,"any",function(){var e=Xe.apply(null,arguments).map(vn);return new F(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(o,u){return F.resolve(o).then(function(c){return t(c)},function(c){i[u]=c,--r||n(new AggregateError(i))})})})}));var Oe={awaits:0,echoes:0,id:0},Gi=0,pn=[],mn=0,yn=0,Qi=0;function rt(e,t,n,r){var i=U,o=Object.create(i);return o.parent=i,o.ref=0,o.global=!1,o.id=++Qi,nt.env,o.env=Ln?{Promise:F,PromiseProp:{value:F,configurable:!0,writable:!0},all:F.all,race:F.race,allSettled:F.allSettled,any:F.any,resolve:F.resolve,reject:F.reject}:{},t&&E(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()},r=pt(o,e,n,r),o.ref===0&&o.finalize(),r}function jt(){return Oe.id||(Oe.id=++Gi),++Oe.awaits,Oe.echoes+=Kr,Oe.id}function it(){return!!Oe.awaits&&(--Oe.awaits==0&&(Oe.id=0),Oe.echoes=Oe.awaits*Kr,!0)}function vn(e){return Oe.echoes&&e&&e.constructor===Wt?(jt(),e.then(function(t){return it(),t},function(t){return it(),be(t)})):e}function Xi(){var e=pn[pn.length-1];pn.pop(),ot(e,!1)}function ot(e,t){var n,r=U;(t?!Oe.echoes||mn++&&e===U:!mn||--mn&&e===U)||queueMicrotask(t?(function(i){++yn,Oe.echoes&&--Oe.echoes!=0||(Oe.echoes=Oe.awaits=Oe.id=0),pn.push(U),ot(i,!0)}).bind(null,e):Xi),e!==U&&(U=e,r===nt&&(nt.env=Ir()),Ln&&(n=nt.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(w,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Ir(){var e=w.Promise;return Ln?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(w,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function pt(e,t,n,r,i){var o=U;try{return ot(e,!0),t(n,r,i)}finally{ot(o,!1)}}function jr(e,t,n,r){return typeof e!="function"?e:function(){var i=U;n&&jt(),ot(t,!0);try{return e.apply(this,arguments)}finally{ot(i,!1),r&&queueMicrotask(it)}}}function Gn(e){Promise===Wt&&Oe.echoes===0?mn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Ue).indexOf("[native code]")===-1&&(jt=it=se);var be=F.reject,mt="￿",Ze="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Tr="String expected.",Tt=[],gn="__dbnames",Qn="readonly",Xn="readwrite";function yt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Rr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function bn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=ge(t))[e],t}}function Br(){throw L.Type()}function re(e,t){try{var n=qr(e),r=qr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(i,o){for(var u=i.length,c=o.length,m=u<c?u:c,h=0;h<m;++h)if(i[h]!==o[h])return i[h]<o[h]?-1:1;return u===c?0:u<c?-1:1}(Nr(e),Nr(t));case"Array":return function(i,o){for(var u=i.length,c=o.length,m=u<c?u:c,h=0;h<m;++h){var g=re(i[h],o[h]);if(g!==0)return g}return u===c?0:u<c?-1:1}(e,t)}}catch{}return NaN}function qr(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Me(e),e==="ArrayBuffer"?"binary":e)}function Nr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Fr=(de.prototype._trans=function(e,t,n){var r=this._tx||U.trans,i=this.name,o=$e&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function u(h,g,f){if(!f.schema[i])throw new L.NotFound("Table "+i+" not part of transaction");return t(f.idbtrans,f)}var c=At();try{var m=r&&r.db._novip===this.db._novip?r===U.trans?r._promise(e,u,n):rt(function(){return r._promise(e,u,n)},{trans:r,transless:U.transless||U}):function h(g,f,b,p){if(g.idbdb&&(g._state.openComplete||U.letThrough||g._vip)){var v=g._createTransaction(f,b,g._dbSchema);try{v.create(),g._state.PR1398_maxLoop=3}catch(_){return _.name===Mn.InvalidState&&g.isOpen()&&0<--g._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),g.close({disableAutoOpen:!1}),g.open().then(function(){return h(g,f,b,p)})):be(_)}return v._promise(f,function(_,y){return rt(function(){return U.trans=v,p(_,y,v)})}).then(function(_){if(f==="readwrite")try{v.idbtrans.commit()}catch{}return f==="readonly"?_:v._completion.then(function(){return _})})}if(g._state.openComplete)return be(new L.DatabaseClosed(g._state.dbOpenError));if(!g._state.isBeingOpened){if(!g._state.autoOpen)return be(new L.DatabaseClosed);g.open().catch(se)}return g._state.dbReadyPromise.then(function(){return h(g,f,b,p)})}(this.db,e,[this.name],u);return o&&(m._consoleTask=o,m=m.catch(function(h){return console.trace(h),be(h)})),m}finally{c&&It()}},de.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?be(new L.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(i){return n.hook.reading.fire(i)})}).then(t)},de.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(x(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=O(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(m){if(m.compound&&t.every(function(g){return 0<=m.keyPath.indexOf(g)})){for(var h=0;h<t.length;++h)if(t.indexOf(m.keyPath[h])===-1)return!1;return!0}return!1}).sort(function(m,h){return m.keyPath.length-h.keyPath.length})[0];if(n&&this.db._maxKey!==mt){var u=n.keyPath.slice(0,t.length);return this.where(u).equals(u.map(function(h){return e[h]}))}!n&&$e&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName,i=this.db._deps.indexedDB;function o(m,h){return i.cmp(m,h)===0}var c=t.reduce(function(b,h){var g=b[0],f=b[1],b=r[h],p=e[h];return[g||b,g||!b?yt(f,b&&b.multi?function(v){return v=Y(v,h),x(v)&&v.some(function(_){return o(p,_)})}:function(v){return o(p,Y(v,h))}):f]},[null,null]),u=c[0],c=c[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(c):n?this.filter(c):this.where(t).equals("")},de.prototype.filter=function(e){return this.toCollection().and(e)},de.prototype.count=function(e){return this.toCollection().count(e)},de.prototype.offset=function(e){return this.toCollection().offset(e)},de.prototype.limit=function(e){return this.toCollection().limit(e)},de.prototype.each=function(e){return this.toCollection().each(e)},de.prototype.toArray=function(e){return this.toCollection().toArray(e)},de.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},de.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,x(e)?"[".concat(e.join("+"),"]"):e))},de.prototype.reverse=function(){return this.toCollection().reverse()},de.prototype.mapToClass=function(e){var t,n=this.db,r=this.name;function i(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Br&&(function(m,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");function g(){this.constructor=m}l(m,h),m.prototype=h===null?Object.create(h):(g.prototype=h.prototype,new g)}(i,t=e),Object.defineProperty(i.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),i.prototype.table=function(){return r},e=i);for(var o=new Set,u=e.prototype;u;u=D(u))Object.getOwnPropertyNames(u).forEach(function(m){return o.add(m)});function c(m){if(!m)return m;var h,g=Object.create(e.prototype);for(h in m)if(!o.has(h))try{g[h]=m[h]}catch{}return g}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=c,this.hook("reading",c),e},de.prototype.defineClass=function(){return this.mapToClass(function(e){E(this,e)})},de.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,u=e;return o&&i&&(u=bn(o)(e)),this._trans("readwrite",function(c){return n.core.mutate({trans:c,type:"add",keys:t!=null?[t]:null,values:[u]})}).then(function(c){return c.numFailures?F.reject(c.failures[0]):c.lastResult}).then(function(c){if(o)try{z(e,o,c)}catch{}return c})},de.prototype.update=function(e,t){return typeof e!="object"||x(e)?this.where(":id").equals(e).modify(t):(e=Y(e,this.schema.primKey.keyPath),e===void 0?be(new L.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},de.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,u=e;return o&&i&&(u=bn(o)(e)),this._trans("readwrite",function(c){return n.core.mutate({trans:c,type:"put",values:[u],keys:t!=null?[t]:null})}).then(function(c){return c.numFailures?F.reject(c.failures[0]):c.lastResult}).then(function(c){if(o)try{z(e,o,c)}catch{}return c})},de.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(n){return n.numFailures?F.reject(n.failures[0]):void 0})},de.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Rr})}).then(function(t){return t.numFailures?F.reject(t.failures[0]):void 0})},de.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(i){return t.hook.reading.fire(i)})})})},de.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(u){var h=r.schema.primKey,c=h.auto,h=h.keyPath;if(h&&i)throw new L.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new L.InvalidArgument("Arguments objects and keys must have the same length");var m=e.length,h=h&&c?e.map(bn(h)):e;return r.core.mutate({trans:u,type:"add",keys:i,values:h,wantResults:o}).then(function(v){var f=v.numFailures,b=v.results,p=v.lastResult,v=v.failures;if(f===0)return o?b:p;throw new Dt("".concat(r.name,".bulkAdd(): ").concat(f," of ").concat(m," operations failed"),v)})})},de.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(u){var h=r.schema.primKey,c=h.auto,h=h.keyPath;if(h&&i)throw new L.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new L.InvalidArgument("Arguments objects and keys must have the same length");var m=e.length,h=h&&c?e.map(bn(h)):e;return r.core.mutate({trans:u,type:"put",keys:i,values:h,wantResults:o}).then(function(v){var f=v.numFailures,b=v.results,p=v.lastResult,v=v.failures;if(f===0)return o?b:p;throw new Dt("".concat(r.name,".bulkPut(): ").concat(f," of ").concat(m," operations failed"),v)})})},de.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(u){return u.key}),i=e.map(function(u){return u.changes}),o=[];return this._trans("readwrite",function(u){return n.getMany({trans:u,keys:r,cache:"clone"}).then(function(c){var m=[],h=[];e.forEach(function(f,b){var p=f.key,v=f.changes,_=c[b];if(_){for(var y=0,P=Object.keys(v);y<P.length;y++){var S=P[y],C=v[S];if(S===t.schema.primKey.keyPath){if(re(C,p)!==0)throw new L.Constraint("Cannot update primary key in bulkUpdate()")}else z(_,S,C)}o.push(b),m.push(p),h.push(_)}});var g=m.length;return n.mutate({trans:u,type:"put",keys:m,values:h,updates:{keys:r,changeSpecs:i}}).then(function(f){var b=f.numFailures,p=f.failures;if(b===0)return g;for(var v=0,_=Object.keys(p);v<_.length;v++){var y,P=_[v],S=o[Number(P)];S!=null&&(y=p[P],delete p[P],p[S]=y)}throw new Dt("".concat(t.name,".bulkUpdate(): ").concat(b," of ").concat(g," operations failed"),p)})})})},de.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e})}).then(function(u){var i=u.numFailures,o=u.lastResult,u=u.failures;if(i===0)return o;throw new Dt("".concat(t.name,".bulkDelete(): ").concat(i," of ").concat(n," operations failed"),u)})},de);function de(){}function Gt(e){function t(u,c){if(c){for(var m=arguments.length,h=new Array(m-1);--m;)h[m-1]=arguments[m];return n[u].subscribe.apply(null,h),e}if(typeof u=="string")return n[u]}var n={};t.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return t;function o(u,c,m){if(typeof u!="object"){var h;c=c||Wi;var g={subscribers:[],fire:m=m||se,subscribe:function(f){g.subscribers.indexOf(f)===-1&&(g.subscribers.push(f),g.fire=c(g.fire,f))},unsubscribe:function(f){g.subscribers=g.subscribers.filter(function(b){return b!==f}),g.fire=g.subscribers.reduce(c,m)}};return n[u]=t[u]=g}O(h=u).forEach(function(f){var b=h[f];if(x(b))o(f,h[f][0],h[f][1]);else{if(b!=="asap")throw new L.InvalidArgument("Invalid event config");var p=o(f,Vt,function(){for(var v=arguments.length,_=new Array(v);v--;)_[v]=arguments[v];p.subscribers.forEach(function(y){q(function(){y.apply(null,_)})})})}})}}function Qt(e,t){return ye(t).from({prototype:e}),t}function Rt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Zn(e,t){e.filter=yt(e.filter,t)}function Jn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return yt(r(),t())}:t,e.justLimit=n&&!r}function _n(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new L.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Mr(e,t,n){var r=_n(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function wn(e,t,n,r){var i=e.replayFilter?yt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},u=function(c,m,h){var g,f;i&&!i(m,h,function(b){return m.stop(b)},function(b){return m.fail(b)})||((f=""+(g=m.primaryKey))=="[object ArrayBuffer]"&&(f=""+new Uint8Array(g)),M(o,f)||(o[f]=!0,t(c,m,h)))};return Promise.all([e.or._iterate(u,n),Ur(Mr(e,r,n),e.algorithm,u,!e.keysOnly&&e.valueMapper)])}return Ur(Mr(e,r,n),yt(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Ur(e,t,n,r){var i=pe(r?function(o,u,c){return n(r(o),u,c)}:n);return e.then(function(o){if(o)return o.start(function(){var u=function(){return o.continue()};t&&!t(o,function(c){return u=c},function(c){o.stop(c),u=se},function(c){o.fail(c),u=se})||i(o.value,o,function(c){return u=c}),u()})})}var Je=Symbol(),Xt=(Lr.prototype.execute=function(e){if(this.add!==void 0){var t=this.add;if(x(t))return k(k([],x(e)?e:[],!0),t).sort();if(typeof t=="number")return(Number(e)||0)+t;if(typeof t=="bigint")try{return BigInt(e)+t}catch{return BigInt(0)+t}throw new TypeError("Invalid term ".concat(t))}if(this.remove!==void 0){var n=this.remove;if(x(n))return x(e)?e.filter(function(r){return!n.includes(r)}).sort():[];if(typeof n=="number")return Number(e)-n;if(typeof n=="bigint")try{return BigInt(e)-n}catch{return BigInt(0)-n}throw new TypeError("Invalid subtrahend ".concat(n))}return t=(t=this.replacePrefix)===null||t===void 0?void 0:t[0],t&&typeof e=="string"&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},Lr);function Lr(e){Object.assign(this,e)}var Zi=(ie.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,be.bind(null,n.error)):n.table._trans("readonly",e).then(t)},ie.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,be.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},ie.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=yt(t.algorithm,e)},ie.prototype._iterate=function(e,t){return wn(this._ctx,e,t,this._ctx.table.core)},ie.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&E(n,e),t._ctx=n,t},ie.prototype.raw=function(){return this._ctx.valueMapper=null,this},ie.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return wn(t,e,n,t.table.core)})},ie.prototype.count=function(e){var t=this;return this._read(function(n){var r=t._ctx,i=r.table.core;if(Rt(r,!0))return i.count({trans:n,query:{index:_n(r,i.schema),range:r.range}}).then(function(u){return Math.min(u,r.limit)});var o=0;return wn(r,function(){return++o,!1},n,i).then(function(){return o})}).then(e)},ie.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(m,h){return h?o(m[n[h]],h-1):m[r]}var u=this._ctx.dir==="next"?1:-1;function c(m,h){return m=o(m,i),h=o(h,i),m<h?-u:h<m?u:0}return this.toArray(function(m){return m.sort(c)}).then(t)},ie.prototype.toArray=function(e){var t=this;return this._read(function(n){var r=t._ctx;if(r.dir==="next"&&Rt(r,!0)&&0<r.limit){var i=r.valueMapper,o=_n(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:o,range:r.range}}).then(function(c){return c=c.result,i?c.map(i):c})}var u=[];return wn(r,function(c){return u.push(c)},n,r.table.core).then(function(){return u})},e)},ie.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Rt(t)?Jn(t,function(){var n=e;return function(r,i){return n===0||(n===1?--n:i(function(){r.advance(n),n=0}),!1)}}):Jn(t,function(){var n=e;return function(){return--n<0}})),this},ie.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Jn(this._ctx,function(){var t=e;return function(n,r,i){return--t<=0&&r(i),0<=t}},!0),this},ie.prototype.until=function(e,t){return Zn(this._ctx,function(n,r,i){return!e(n.value)||(r(i),t)}),this},ie.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},ie.prototype.last=function(e){return this.reverse().first(e)},ie.prototype.filter=function(e){var t;return Zn(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=yt(t.isMatch,e),this},ie.prototype.and=function(e){return this.filter(e)},ie.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},ie.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ie.prototype.desc=function(){return this.reverse()},ie.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},ie.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},ie.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},ie.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,i){n.push(i.key)}).then(function(){return n}).then(e)},ie.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&Rt(t,!0)&&0<t.limit)return this._read(function(r){var i=_n(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:i,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,i){n.push(i.primaryKey)}).then(function(){return n}).then(e)},ie.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},ie.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},ie.prototype.lastKey=function(e){return this.reverse().firstKey(e)},ie.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return Zn(this._ctx,function(i){var r=i.primaryKey.toString(),i=M(t,r);return t[r]=!0,!i}),this},ie.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var i,o,u;u=typeof e=="function"?e:(i=O(e),o=i.length,function(y){for(var P=!1,S=0;S<o;++S){var C=i[S],K=e[C],I=Y(y,C);K instanceof Xt?(z(y,C,K.execute(I)),P=!0):I!==K&&(z(y,C,K),P=!0)}return P});function c(y,C){var S=C.failures,C=C.numFailures;v+=y-C;for(var K=0,I=O(S);K<I.length;K++){var B=I[K];p.push(S[B])}}var m=n.table.core,h=m.schema.primaryKey,g=h.outbound,f=h.extractKey,b=t.db._options.modifyChunkSize||200,p=[],v=0,_=[];return t.clone().primaryKeys().then(function(y){function P(C){var K=Math.min(b,y.length-C);return m.getMany({trans:r,keys:y.slice(C,C+K),cache:"immutable"}).then(function(I){for(var B=[],j=[],R=g?[]:null,N=[],A=0;A<K;++A){var H=I[A],Q={value:ge(H),primKey:y[C+A]};u.call(Q,Q.value,Q)!==!1&&(Q.value==null?N.push(y[C+A]):g||re(f(H),f(Q.value))===0?(j.push(Q.value),g&&R.push(y[C+A])):(N.push(y[C+A]),B.push(Q.value)))}return Promise.resolve(0<B.length&&m.mutate({trans:r,type:"add",values:B}).then(function(ne){for(var J in ne.failures)N.splice(parseInt(J),1);c(B.length,ne)})).then(function(){return(0<j.length||S&&typeof e=="object")&&m.mutate({trans:r,type:"put",keys:R,values:j,criteria:S,changeSpec:typeof e!="function"&&e,isAdditionalChunk:0<C}).then(function(ne){return c(j.length,ne)})}).then(function(){return(0<N.length||S&&e===er)&&m.mutate({trans:r,type:"delete",keys:N,criteria:S,isAdditionalChunk:0<C}).then(function(ne){return c(N.length,ne)})}).then(function(){return y.length>C+K&&P(C+b)})})}var S=Rt(n)&&n.limit===1/0&&(typeof e!="function"||e===er)&&{index:n.index,range:n.range};return P(0).then(function(){if(0<p.length)throw new sn("Error modifying one or more objects",p,v,_);return y.length})})})},ie.prototype.delete=function(){var e=this._ctx,t=e.range;return Rt(e)&&(e.isPrimKey||t.type===3)?this._write(function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(function(o){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(function(u){var c=u.failures;if(u.lastResult,u.results,u=u.numFailures,u)throw new sn("Could not delete some values",Object.keys(c).map(function(m){return c[m]}),o-u);return o-u})})}):this.modify(er)},ie);function ie(){}var er=function(e,t){return t.value=null};function Ji(e,t){return e<t?-1:e===t?0:1}function eo(e,t){return t<e?-1:e===t?0:1}function Fe(e,t,n){return e=e instanceof zr?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function Bt(e){return new e.Collection(e,function(){return Vr("")}).limit(0)}function kn(e,t,n,r){var i,o,u,c,m,h,g,f=n.length;if(!n.every(function(v){return typeof v=="string"}))return Fe(e,Tr);function b(v){i=v==="next"?function(y){return y.toUpperCase()}:function(y){return y.toLowerCase()},o=v==="next"?function(y){return y.toLowerCase()}:function(y){return y.toUpperCase()},u=v==="next"?Ji:eo;var _=n.map(function(y){return{lower:o(y),upper:i(y)}}).sort(function(y,P){return u(y.lower,P.lower)});c=_.map(function(y){return y.upper}),m=_.map(function(y){return y.lower}),g=(h=v)==="next"?"":r}b("next"),e=new e.Collection(e,function(){return at(c[0],m[f-1]+r)}),e._ondirectionchange=function(v){b(v)};var p=0;return e._addAlgorithm(function(v,_,y){var P=v.key;if(typeof P!="string")return!1;var S=o(P);if(t(S,m,p))return!0;for(var C=null,K=p;K<f;++K){var I=function(B,j,R,N,A,H){for(var Q=Math.min(B.length,N.length),ne=-1,J=0;J<Q;++J){var Ve=j[J];if(Ve!==N[J])return A(B[J],R[J])<0?B.substr(0,J)+R[J]+R.substr(J+1):A(B[J],N[J])<0?B.substr(0,J)+N[J]+R.substr(J+1):0<=ne?B.substr(0,ne)+j[ne]+R.substr(ne+1):null;A(B[J],Ve)<0&&(ne=J)}return Q<N.length&&H==="next"?B+R.substr(B.length):Q<B.length&&H==="prev"?B.substr(0,R.length):ne<0?null:B.substr(0,ne)+N[ne]+R.substr(ne+1)}(P,S,c[K],m[K],u,h);I===null&&C===null?p=K+1:(C===null||0<u(C,I))&&(C=I)}return _(C!==null?function(){v.continue(C+g)}:y),!1}),e}function at(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Vr(e){return{type:1,lower:e,upper:e}}var zr=(Object.defineProperty(Ee.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ee.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?Bt(this):new this.Collection(this,function(){return at(e,t,!n,!r)})}catch{return Fe(this,Ze)}},Ee.prototype.equals=function(e){return e==null?Fe(this,Ze):new this.Collection(this,function(){return Vr(e)})},Ee.prototype.above=function(e){return e==null?Fe(this,Ze):new this.Collection(this,function(){return at(e,void 0,!0)})},Ee.prototype.aboveOrEqual=function(e){return e==null?Fe(this,Ze):new this.Collection(this,function(){return at(e,void 0,!1)})},Ee.prototype.below=function(e){return e==null?Fe(this,Ze):new this.Collection(this,function(){return at(void 0,e,!1,!0)})},Ee.prototype.belowOrEqual=function(e){return e==null?Fe(this,Ze):new this.Collection(this,function(){return at(void 0,e)})},Ee.prototype.startsWith=function(e){return typeof e!="string"?Fe(this,Tr):this.between(e,e+mt,!0,!0)},Ee.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):kn(this,function(t,n){return t.indexOf(n[0])===0},[e],mt)},Ee.prototype.equalsIgnoreCase=function(e){return kn(this,function(t,n){return t===n[0]},[e],"")},Ee.prototype.anyOfIgnoreCase=function(){var e=Xe.apply(Ct,arguments);return e.length===0?Bt(this):kn(this,function(t,n){return n.indexOf(t)!==-1},e,"")},Ee.prototype.startsWithAnyOfIgnoreCase=function(){var e=Xe.apply(Ct,arguments);return e.length===0?Bt(this):kn(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,mt)},Ee.prototype.anyOf=function(){var e=this,t=Xe.apply(Ct,arguments),n=this._cmp;try{t.sort(n)}catch{return Fe(this,Ze)}if(t.length===0)return Bt(this);var r=new this.Collection(this,function(){return at(t[0],t[t.length-1])});r._ondirectionchange=function(o){n=o==="next"?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm(function(o,u,c){for(var m=o.key;0<n(m,t[i]);)if(++i===t.length)return u(c),!1;return n(m,t[i])===0||(u(function(){o.continue(t[i])}),!1)}),r},Ee.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ee.prototype.noneOf=function(){var e=Xe.apply(Ct,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Fe(this,Ze)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Ee.prototype.inAnyRange=function(P,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,u=this._min,c=this._max;if(P.length===0)return Bt(this);if(!P.every(function(S){return S[0]!==void 0&&S[1]!==void 0&&i(S[0],S[1])<=0}))return Fe(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",L.InvalidArgument);var m=!t||t.includeLowers!==!1,h=t&&t.includeUppers===!0,g,f=i;function b(S,C){return f(S[0],C[0])}try{(g=P.reduce(function(S,C){for(var K=0,I=S.length;K<I;++K){var B=S[K];if(r(C[0],B[1])<0&&0<r(C[1],B[0])){B[0]=u(B[0],C[0]),B[1]=c(B[1],C[1]);break}}return K===I&&S.push(C),S},[])).sort(b)}catch{return Fe(this,Ze)}var p=0,v=h?function(S){return 0<i(S,g[p][1])}:function(S){return 0<=i(S,g[p][1])},_=m?function(S){return 0<o(S,g[p][0])}:function(S){return 0<=o(S,g[p][0])},y=v,P=new this.Collection(this,function(){return at(g[0][0],g[g.length-1][1],!m,!h)});return P._ondirectionchange=function(S){f=S==="next"?(y=v,i):(y=_,o),g.sort(b)},P._addAlgorithm(function(S,C,K){for(var I,B=S.key;y(B);)if(++p===g.length)return C(K),!1;return!v(I=B)&&!_(I)||(n._cmp(B,g[p][1])===0||n._cmp(B,g[p][0])===0||C(function(){f===i?S.continue(g[p][0]):S.continue(g[p][1])}),!1)}),P},Ee.prototype.startsWithAnyOf=function(){var e=Xe.apply(Ct,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?Bt(this):this.inAnyRange(e.map(function(t){return[t,t+mt]})):Fe(this,"startsWithAnyOf() only works with strings")},Ee);function Ee(){}function He(e){return pe(function(t){return Zt(t),e(t.target.error),!1})}function Zt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Jt="storagemutated",tr="x-storagemutated-1",ut=Gt(null,Jt),to=(Ge.prototype._lock=function(){return V(!U.global),++this._reculock,this._reculock!==1||U.global||(U.lockOwnerFor=this),this},Ge.prototype._unlock=function(){if(V(!U.global),--this._reculock==0)for(U.global||(U.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{pt(e[1],e[0])}catch{}}return this},Ge.prototype._locked=function(){return this._reculock&&U.lockOwnerFor!==this},Ge.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(V(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new L.DatabaseClosed(r);case"MissingAPIError":throw new L.MissingAPI(r.message,r);default:throw new L.OpenFailed(r)}if(!this.active)throw new L.TransactionInactive;return V(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=pe(function(i){Zt(i),t._reject(e.error)}),e.onabort=pe(function(i){Zt(i),t.active&&t._reject(new L.Abort(e.error)),t.active=!1,t.on("abort").fire(i)}),e.oncomplete=pe(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&ut.storagemutated.fire(e.mutatedParts)}),this},Ge.prototype._promise=function(e,t,n){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return be(new L.ReadOnly("Transaction is readonly"));if(!this.active)return be(new L.TransactionInactive);if(this._locked())return new F(function(o,u){r._blockedFuncs.push([function(){r._promise(e,t,n).then(o,u)},U])});if(n)return rt(function(){var o=new F(function(u,c){r._lock();var m=t(u,c,r);m&&m.then&&m.then(u,c)});return o.finally(function(){return r._unlock()}),o._lib=!0,o});var i=new F(function(o,u){var c=t(o,u,r);c&&c.then&&c.then(o,u)});return i._lib=!0,i},Ge.prototype._root=function(){return this.parent?this.parent._root():this},Ge.prototype.waitFor=function(e){var t,n=this._root(),r=F.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=o)}());var i=n._waitingFor;return new F(function(o,u){r.then(function(c){return n._waitingQueue.push(pe(o.bind(null,c)))},function(c){return n._waitingQueue.push(pe(u.bind(null,c)))}).finally(function(){n._waitingFor===i&&(n._waitingFor=null)})})},Ge.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new L.Abort))},Ge.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(M(t,e))return t[e];var n=this.schema[e];if(!n)throw new L.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},Ge);function Ge(){}function nr(e,t,n,r,i,o,u){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!u?"&":"")+(r?"*":"")+(i?"++":"")+Yr(t)}}function Yr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function rr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(i){return[i.name,i]},n.reduce(function(i,o,u){return u=r(o,u),u&&(i[u[0]]=u[1]),i},{}))};var r}var en=function(e){try{return e.only([[]]),en=function(){return[[]]},[[]]}catch{return en=function(){return mt},mt}};function ir(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return Y(n,t)}:function(n){return Y(n,e)};var t}function Wr(e){return[].slice.call(e)}var no=0;function tn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function ro(e,t,m){function r(y){if(y.type===3)return null;if(y.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var p=y.lower,v=y.upper,_=y.lowerOpen,y=y.upperOpen;return p===void 0?v===void 0?null:t.upperBound(v,!!y):v===void 0?t.lowerBound(p,!!_):t.bound(p,v,!!_,!!y)}function i(b){var p,v=b.name;return{name:v,schema:b,mutate:function(_){var y=_.trans,P=_.type,S=_.keys,C=_.values,K=_.range;return new Promise(function(I,B){I=pe(I);var j=y.objectStore(v),R=j.keyPath==null,N=P==="put"||P==="add";if(!N&&P!=="delete"&&P!=="deleteRange")throw new Error("Invalid operation type: "+P);var A,H=(S||C||{length:1}).length;if(S&&C&&S.length!==C.length)throw new Error("Given keys array must have same length as given values array.");if(H===0)return I({numFailures:0,failures:{},results:[],lastResult:void 0});function Q(Ne){++Ve,Zt(Ne)}var ne=[],J=[],Ve=0;if(P==="deleteRange"){if(K.type===4)return I({numFailures:Ve,failures:J,results:[],lastResult:void 0});K.type===3?ne.push(A=j.clear()):ne.push(A=j.delete(r(K)))}else{var R=N?R?[C,S]:[C,null]:[S,null],ee=R[0],Ce=R[1];if(N)for(var Ke=0;Ke<H;++Ke)ne.push(A=Ce&&Ce[Ke]!==void 0?j[P](ee[Ke],Ce[Ke]):j[P](ee[Ke])),A.onerror=Q;else for(Ke=0;Ke<H;++Ke)ne.push(A=j[P](ee[Ke])),A.onerror=Q}function Rn(Ne){Ne=Ne.target.result,ne.forEach(function(bt,kr){return bt.error!=null&&(J[kr]=bt.error)}),I({numFailures:Ve,failures:J,results:P==="delete"?S:ne.map(function(bt){return bt.result}),lastResult:Ne})}A.onerror=function(Ne){Q(Ne),Rn(Ne)},A.onsuccess=Rn})},getMany:function(_){var y=_.trans,P=_.keys;return new Promise(function(S,C){S=pe(S);for(var K,I=y.objectStore(v),B=P.length,j=new Array(B),R=0,N=0,A=function(ne){ne=ne.target,j[ne._pos]=ne.result,++N===R&&S(j)},H=He(C),Q=0;Q<B;++Q)P[Q]!=null&&((K=I.get(P[Q]))._pos=Q,K.onsuccess=A,K.onerror=H,++R);R===0&&S(j)})},get:function(_){var y=_.trans,P=_.key;return new Promise(function(S,C){S=pe(S);var K=y.objectStore(v).get(P);K.onsuccess=function(I){return S(I.target.result)},K.onerror=He(C)})},query:(p=h,function(_){return new Promise(function(y,P){y=pe(y);var S,C,K,R=_.trans,I=_.values,B=_.limit,A=_.query,j=B===1/0?void 0:B,N=A.index,A=A.range,R=R.objectStore(v),N=N.isPrimaryKey?R:R.index(N.name),A=r(A);if(B===0)return y({result:[]});p?((j=I?N.getAll(A,j):N.getAllKeys(A,j)).onsuccess=function(H){return y({result:H.target.result})},j.onerror=He(P)):(S=0,C=!I&&"openKeyCursor"in N?N.openKeyCursor(A):N.openCursor(A),K=[],C.onsuccess=function(H){var Q=C.result;return Q?(K.push(I?Q.value:Q.primaryKey),++S===B?y({result:K}):void Q.continue()):y({result:K})},C.onerror=He(P))})}),openCursor:function(_){var y=_.trans,P=_.values,S=_.query,C=_.reverse,K=_.unique;return new Promise(function(I,B){I=pe(I);var N=S.index,j=S.range,R=y.objectStore(v),R=N.isPrimaryKey?R:R.index(N.name),N=C?K?"prevunique":"prev":K?"nextunique":"next",A=!P&&"openKeyCursor"in R?R.openKeyCursor(r(j),N):R.openCursor(r(j),N);A.onerror=He(B),A.onsuccess=pe(function(H){var Q,ne,J,Ve,ee=A.result;ee?(ee.___id=++no,ee.done=!1,Q=ee.continue.bind(ee),ne=(ne=ee.continuePrimaryKey)&&ne.bind(ee),J=ee.advance.bind(ee),Ve=function(){throw new Error("Cursor not stopped")},ee.trans=y,ee.stop=ee.continue=ee.continuePrimaryKey=ee.advance=function(){throw new Error("Cursor not started")},ee.fail=pe(B),ee.next=function(){var Ce=this,Ke=1;return this.start(function(){return Ke--?Ce.continue():Ce.stop()}).then(function(){return Ce})},ee.start=function(Ce){function Ke(){if(A.result)try{Ce()}catch(Ne){ee.fail(Ne)}else ee.done=!0,ee.start=function(){throw new Error("Cursor behind last entry")},ee.stop()}var Rn=new Promise(function(Ne,bt){Ne=pe(Ne),A.onerror=He(bt),ee.fail=bt,ee.stop=function(kr){ee.stop=ee.continue=ee.continuePrimaryKey=ee.advance=Ve,Ne(kr)}});return A.onsuccess=pe(function(Ne){A.onsuccess=Ke,Ke()}),ee.continue=Q,ee.continuePrimaryKey=ne,ee.advance=J,Ke(),Rn},I(ee)):I(null)},B)})},count:function(_){var y=_.query,P=_.trans,S=y.index,C=y.range;return new Promise(function(K,I){var B=P.objectStore(v),j=S.isPrimaryKey?B:B.index(S.name),B=r(C),j=B?j.count(B):j.count();j.onsuccess=pe(function(R){return K(R.target.result)}),j.onerror=He(I)})}}}var o,u,c,g=(u=m,c=Wr((o=e).objectStoreNames),{schema:{name:o.name,tables:c.map(function(b){return u.objectStore(b)}).map(function(b){var p=b.keyPath,y=b.autoIncrement,v=x(p),_={},y={name:b.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:p==null,compound:v,keyPath:p,autoIncrement:y,unique:!0,extractKey:ir(p)},indexes:Wr(b.indexNames).map(function(P){return b.index(P)}).map(function(K){var S=K.name,C=K.unique,I=K.multiEntry,K=K.keyPath,I={name:S,compound:x(K),keyPath:K,unique:C,multiEntry:I,extractKey:ir(K)};return _[tn(K)]=I}),getIndexByKeyPath:function(P){return _[tn(P)]}};return _[":id"]=y.primaryKey,p!=null&&(_[tn(p)]=y.primaryKey),y})},hasGetAll:0<c.length&&"getAll"in u.objectStore(c[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),m=g.schema,h=g.hasGetAll,g=m.tables.map(i),f={};return g.forEach(function(b){return f[b.name]=b}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(b){if(!f[b])throw new Error("Table '".concat(b,"' not found"));return f[b]},MIN_KEY:-1/0,MAX_KEY:en(t),schema:m}}function io(e,t,n,r){var i=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=ro(t,i,r),e.dbcore.reduce(function(o,u){return u=u.create,s(s({},o),u(o))},r))}}function xn(e,r){var n=r.db,r=io(e._middlewares,n,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(i){var o=i.name;e.core.schema.tables.some(function(u){return u.name===o})&&(i.core=e.core.table(o),e[o]instanceof e.Table&&(e[o].core=i.core))})}function Pn(e,t,n,r){n.forEach(function(i){var o=r[i];t.forEach(function(u){var c=function m(h,g){return we(h,g)||(h=D(h))&&m(h,g)}(u,i);(!c||"value"in c&&c.value===void 0)&&(u===e.Transaction.prototype||u instanceof e.Transaction?X(u,i,{get:function(){return this.table(i)},set:function(m){ue(this,i,{value:m,writable:!0,configurable:!0,enumerable:!0})}}):u[i]=new e.Table(i,o))})})}function or(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function oo(e,t){return e._cfg.version-t._cfg.version}function ao(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=rr("$meta",Hr("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,i);o.create(n),o._completion.catch(r);var u=o._reject.bind(o),c=U.transless||U;rt(function(){return U.trans=o,U.transless=c,t!==0?(xn(e,n),h=t,((m=o).storeNames.includes("$meta")?m.table("$meta").get("version").then(function(g){return g??h}):F.resolve(h)).then(function(g){return b=g,p=o,v=n,_=[],g=(f=e)._versions,y=f._dbSchema=En(0,f.idbdb,v),(g=g.filter(function(P){return P._cfg.version>=b})).length!==0?(g.forEach(function(P){_.push(function(){var S=y,C=P._cfg.dbschema;Sn(f,S,v),Sn(f,C,v),y=f._dbSchema=C;var K=ar(S,C);K.add.forEach(function(N){ur(v,N[0],N[1].primKey,N[1].indexes)}),K.change.forEach(function(N){if(N.recreate)throw new L.Upgrade("Not yet support for changing primary key");var A=v.objectStore(N.name);N.add.forEach(function(H){return On(A,H)}),N.change.forEach(function(H){A.deleteIndex(H.name),On(A,H)}),N.del.forEach(function(H){return A.deleteIndex(H)})});var I=P._cfg.contentUpgrade;if(I&&P._cfg.version>b){xn(f,v),p._memoizedTables={};var B=ae(C);K.del.forEach(function(N){B[N]=S[N]}),or(f,[f.Transaction.prototype]),Pn(f,[f.Transaction.prototype],O(B),B),p.schema=B;var j,R=Fn(I);return R&&jt(),K=F.follow(function(){var N;(j=I(p))&&R&&(N=it.bind(null,null),j.then(N,N))}),j&&typeof j.then=="function"?F.resolve(j):K.then(function(){return j})}}),_.push(function(S){var C,K,I=P._cfg.dbschema;C=I,K=S,[].slice.call(K.db.objectStoreNames).forEach(function(B){return C[B]==null&&K.db.deleteObjectStore(B)}),or(f,[f.Transaction.prototype]),Pn(f,[f.Transaction.prototype],f._storeNames,f._dbSchema),p.schema=f._dbSchema}),_.push(function(S){f.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(f.idbdb.version/10)===P._cfg.version?(f.idbdb.deleteObjectStore("$meta"),delete f._dbSchema.$meta,f._storeNames=f._storeNames.filter(function(C){return C!=="$meta"})):S.objectStore("$meta").put(P._cfg.version,"version"))})}),function P(){return _.length?F.resolve(_.shift()(p.idbtrans)).then(P):F.resolve()}().then(function(){$r(y,v)})):F.resolve();var f,b,p,v,_,y}).catch(u)):(O(i).forEach(function(g){ur(n,g,i[g].primKey,i[g].indexes)}),xn(e,n),void F.follow(function(){return e.on.populate.fire(o)}).catch(u));var m,h})}function uo(e,t){$r(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=En(0,e.idbdb,t);Sn(e,e._dbSchema,t);for(var r=0,i=ar(n,e._dbSchema).change;r<i.length;r++){var o=function(u){if(u.change.length||u.recreate)return console.warn("Unable to patch indexes of table ".concat(u.name," because it has changes on the type of index or primary key.")),{value:void 0};var c=t.objectStore(u.name);u.add.forEach(function(m){$e&&console.debug("Dexie upgrade patch: Creating missing index ".concat(u.name,".").concat(m.src)),On(c,m)})}(i[r]);if(typeof o=="object")return o.value}}function ar(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var u={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto)u.recreate=!0,r.change.push(u);else{var c=i.idxByName,m=o.idxByName,h=void 0;for(h in c)m[h]||u.del.push(h);for(h in m){var g=c[h],f=m[h];g?g.src!==f.src&&u.change.push(f):u.add.push(f)}(0<u.del.length||0<u.add.length||0<u.change.length)&&r.change.push(u)}}else r.add.push([n,o])}return r}function ur(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(o){return On(i,o)}),i}function $r(e,t){O(e).forEach(function(n){t.db.objectStoreNames.contains(n)||($e&&console.debug("Dexie: Creating missing table",n),ur(t,n,e[n].primKey,e[n].indexes))})}function On(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function En(e,t,n){var r={};return fe(t.objectStoreNames,0).forEach(function(i){for(var o=n.objectStore(i),u=nr(Yr(h=o.keyPath),h||"",!0,!1,!!o.autoIncrement,h&&typeof h!="string",!0),c=[],m=0;m<o.indexNames.length;++m){var g=o.index(o.indexNames[m]),h=g.keyPath,g=nr(g.name,h,!!g.unique,!!g.multiEntry,!1,h&&typeof h!="string",!1);c.push(g)}r[i]=rr(i,u,c)}),r}function Sn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var o=r[i],u=n.objectStore(o);e._hasGetAll="getAll"in u;for(var c=0;c<u.indexNames.length;++c){var m=u.indexNames[c],h=u.index(m).keyPath,g=typeof h=="string"?h:"["+fe(h).join("+")+"]";!t[o]||(h=t[o].idxByName[g])&&(h.name=m,delete t[o].idxByName[g],t[o].idxByName[m]=h)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&w.WorkerGlobalScope&&w instanceof w.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Hr(e){return e.split(",").map(function(t,n){var r=(t=t.trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return nr(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),x(i),n===0)})}var so=(Cn.prototype._parseStoresSpec=function(e,t){O(e).forEach(function(n){if(e[n]!==null){var r=Hr(e[n]),i=r.shift();if(i.unique=!0,i.multi)throw new L.Schema("Primary key cannot be multi-valued");r.forEach(function(o){if(o.auto)throw new L.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new L.Schema("Index must have a name and cannot be an empty string")}),t[n]=rr(n,i,r)}})},Cn.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?E(this._cfg.storesSource,n):n;var n=t._versions,r={},i={};return n.forEach(function(o){E(r,o._cfg.storesSource),i=o._cfg.dbschema={},o._parseStoresSpec(r,i)}),t._dbSchema=i,or(t,[t._allTables,t,t.Transaction.prototype]),Pn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],O(i),i),t._storeNames=O(i),this},Cn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Un(this._cfg.contentUpgrade||se,e),this},Cn);function Cn(){}function sr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new et(gn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function cr(e){return e&&typeof e.databases=="function"}function lr(e){return rt(function(){return U.letThrough=!0,e()})}function fr(e){return!("from"in e)}var qe=function(e,t){if(!this){var n=new qe;return e&&"d"in e&&E(n,e),n}E(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function nn(e,t,n){var r=re(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(fr(e))return E(e,{from:t,to:n,d:1});var i=e.l,r=e.r;if(re(n,e.from)<0)return i?nn(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Qr(e);if(0<re(t,e.to))return r?nn(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Qr(e);re(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<re(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,i&&!e.l&&rn(e,i),r&&n&&rn(e,r)}}function rn(e,t){fr(t)||function n(r,m){var o=m.from,u=m.to,c=m.l,m=m.r;nn(r,o,u),c&&n(r,c),m&&n(r,m)}(e,t)}function Gr(e,t){var n=Kn(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=Kn(e),u=o.next(i.from),c=u.value;!r.done&&!u.done;){if(re(c.from,i.to)<=0&&0<=re(c.to,i.from))return!0;re(i.from,c.from)<0?i=(r=n.next(c.from)).value:c=(u=o.next(i.from)).value}return!1}function Kn(e){var t=fr(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&re(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||re(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Qr(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=1<r?"r":r<-1?"l":"";i&&(t=i=="r"?"l":"r",n=s({},e),r=e[i],e.from=r.from,e.to=r.to,e[i]=r[i],n[i]=r[t],(e[t]=n).d=Xr(n)),e.d=Xr(e)}function Xr(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Dn(e,t){return O(t).forEach(function(n){e[n]?rn(e[n],t[n]):e[n]=function r(i){var o,u,c={};for(o in i)M(i,o)&&(u=i[o],c[o]=!u||typeof u!="object"||Se.has(u.constructor)?u:r(u));return c}(t[n])}),e}function hr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&Gr(t[n],e[n])})}oe(qe.prototype,((Ue={add:function(e){return rn(this,e),this},addKey:function(e){return nn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return nn(t,n,n)}),this},hasKey:function(e){var t=Kn(this).next(e).value;return t&&re(t.from,e)<=0&&0<=re(t.to,e)}})[Be]=function(){return Kn(this)},Ue));var vt={},dr={},pr=!1;function An(e){Dn(dr,e),pr||(pr=!0,setTimeout(function(){pr=!1,mr(dr,!(dr={}))},0))}function mr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(vt);r<i.length;r++)Zr(u=i[r],e,n,t);else for(var o in e){var u,c=/^idb\:\/\/(.*)\/(.*)\//.exec(o);c&&(o=c[1],c=c[2],(u=vt["idb://".concat(o,"/").concat(c)])&&Zr(u,e,n,t))}n.forEach(function(m){return m()})}function Zr(e,t,n,r){for(var i=[],o=0,u=Object.entries(e.queries.query);o<u.length;o++){for(var c=u[o],m=c[0],h=[],g=0,f=c[1];g<f.length;g++){var b=f[g];hr(t,b.obsSet)?b.subscribers.forEach(function(y){return n.add(y)}):r&&h.push(b)}r&&i.push([m,h])}if(r)for(var p=0,v=i;p<v.length;p++){var _=v[p],m=_[0],h=_[1];e.queries.query[m]=h}}function co(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?be(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(10*e.verno),o=!1;function u(){if(t.openCanceller!==r)throw new L.DatabaseClosed("db.open() was cancelled")}function c(){return new F(function(b,p){if(u(),!n)throw new L.MissingAPI;var v=e.name,_=t.autoSchema||!i?n.open(v):n.open(v,i);if(!_)throw new L.MissingAPI;_.onerror=He(p),_.onblocked=pe(e._fireOnBlocked),_.onupgradeneeded=pe(function(y){var P;g=_.transaction,t.autoSchema&&!e._options.allowEmptyDB?(_.onerror=Zt,g.abort(),_.result.close(),(P=n.deleteDatabase(v)).onsuccess=P.onerror=pe(function(){p(new L.NoSuchDatabase("Database ".concat(v," doesnt exist")))})):(g.onerror=He(p),y=y.oldVersion>Math.pow(2,62)?0:y.oldVersion,f=y<1,e.idbdb=_.result,o&&uo(e,g),ao(e,y/10,g,p))},p),_.onsuccess=pe(function(){g=null;var y,P,S,C,K,I=e.idbdb=_.result,B=fe(I.objectStoreNames);if(0<B.length)try{var j=I.transaction((C=B).length===1?C[0]:C,"readonly");if(t.autoSchema)P=I,S=j,(y=e).verno=P.version/10,S=y._dbSchema=En(0,P,S),y._storeNames=fe(P.objectStoreNames,0),Pn(y,[y._allTables],O(S),S);else if(Sn(e,e._dbSchema,j),((K=ar(En(0,(K=e).idbdb,j),K._dbSchema)).add.length||K.change.some(function(R){return R.add.length||R.change.length}))&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),I.close(),i=I.version+1,o=!0,b(c());xn(e,j)}catch{}Tt.push(e),I.onversionchange=pe(function(R){t.vcFired=!0,e.on("versionchange").fire(R)}),I.onclose=pe(function(R){e.on("close").fire(R)}),f&&(K=e._deps,j=v,I=K.indexedDB,K=K.IDBKeyRange,cr(I)||j===gn||sr(I,K).put({name:j}).catch(se)),b()},p)}).catch(function(b){switch(b==null?void 0:b.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c();break;case"VersionError":if(0<i)return i=0,c()}return F.reject(b)})}var m,h=t.dbReadyResolve,g=null,f=!1;return F.race([r,(typeof navigator>"u"?F.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(b){function p(){return indexedDB.databases().finally(b)}m=setInterval(p,100),p()}).finally(function(){return clearInterval(m)}):Promise.resolve()).then(c)]).then(function(){return u(),t.onReadyBeingFired=[],F.resolve(lr(function(){return e.on.ready.fire(e.vip)})).then(function b(){if(0<t.onReadyBeingFired.length){var p=t.onReadyBeingFired.reduce(Un,se);return t.onReadyBeingFired=[],F.resolve(lr(function(){return p(e.vip)})).then(b)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(b){t.dbOpenError=b;try{g&&g.abort()}catch{}return r===t.openCanceller&&e._close(),be(b)}).finally(function(){t.openComplete=!0,h()}).then(function(){var b;return f&&(b={},e.tables.forEach(function(p){p.schema.indexes.forEach(function(v){v.name&&(b["idb://".concat(e.name,"/").concat(p.name,"/").concat(v.name)]=new qe(-1/0,[[[]]]))}),b["idb://".concat(e.name,"/").concat(p.name,"/")]=b["idb://".concat(e.name,"/").concat(p.name,"/:dels")]=new qe(-1/0,[[[]]])}),ut(Jt).fire(b),mr(b,!0)),e})}function yr(e){function t(o){return e.next(o)}var n=i(t),r=i(function(o){return e.throw(o)});function i(o){return function(m){var c=o(m),m=c.value;return c.done?m:m&&typeof m.then=="function"?m.then(n,r):x(m)?Promise.all(m).then(n,r):n(m)}}return i(t)()}function In(e,t,n){for(var r=x(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var lo={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return s(s({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},o=[];function u(f,b,p){var v=tn(f),_=i[v]=i[v]||[],y=f==null?0:typeof f=="string"?1:f.length,P=0<b,P=s(s({},p),{name:P?"".concat(v,"(virtual-from:").concat(p.name,")"):p.name,lowLevelIndex:p,isVirtual:P,keyTail:b,keyLength:y,extractKey:ir(f),unique:!P&&p.unique});return _.push(P),P.isPrimaryKey||o.push(P),1<y&&u(y===2?f[0]:f.slice(0,y-1),b+1,p),_.sort(function(S,C){return S.keyTail-C.keyTail}),P}t=u(r.primaryKey.keyPath,0,r.primaryKey),i[":id"]=[t];for(var c=0,m=r.indexes;c<m.length;c++){var h=m[c];u(h.keyPath,0,h)}function g(f){var b,p=f.query.index;return p.isVirtual?s(s({},f),{query:{index:p.lowLevelIndex,range:(b=f.query.range,p=p.keyTail,{type:b.type===1?2:b.type,lower:In(b.lower,b.lowerOpen?e.MAX_KEY:e.MIN_KEY,p),lowerOpen:!0,upper:In(b.upper,b.upperOpen?e.MIN_KEY:e.MAX_KEY,p),upperOpen:!0})}}):f}return s(s({},n),{schema:s(s({},r),{primaryKey:t,indexes:o,getIndexByKeyPath:function(f){return(f=i[tn(f)])&&f[0]}}),count:function(f){return n.count(g(f))},query:function(f){return n.query(g(f))},openCursor:function(f){var b=f.query.index,p=b.keyTail,v=b.isVirtual,_=b.keyLength;return v?n.openCursor(g(f)).then(function(P){return P&&y(P)}):n.openCursor(f);function y(P){return Object.create(P,{continue:{value:function(S){S!=null?P.continue(In(S,f.reverse?e.MAX_KEY:e.MIN_KEY,p)):f.unique?P.continue(P.key.slice(0,_).concat(f.reverse?e.MIN_KEY:e.MAX_KEY,p)):P.continue()}},continuePrimaryKey:{value:function(S,C){P.continuePrimaryKey(In(S,e.MAX_KEY,p),C)}},primaryKey:{get:function(){return P.primaryKey}},key:{get:function(){var S=P.key;return _===1?S[0]:S.slice(0,_)}},value:{get:function(){return P.value}}})}}})}})}};function vr(e,t,n,r){return n=n||{},r=r||"",O(e).forEach(function(i){var o,u,c;M(t,i)?(o=e[i],u=t[i],typeof o=="object"&&typeof u=="object"&&o&&u?(c=Me(o))!==Me(u)?n[r+i]=t[i]:c==="Object"?vr(o,u,n,r+i+"."):o!==u&&(n[r+i]=t[i]):o!==u&&(n[r+i]=t[i])):n[r+i]=void 0}),O(t).forEach(function(i){M(e,i)||(n[r+i]=t[i])}),n}function gr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var fo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return s(s({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return s(s({},n),{mutate:function(i){var o=U.trans,u=o.table(t).hook,c=u.deleting,m=u.creating,h=u.updating;switch(i.type){case"add":if(m.fire===se)break;return o._promise("readwrite",function(){return g(i)},!0);case"put":if(m.fire===se&&h.fire===se)break;return o._promise("readwrite",function(){return g(i)},!0);case"delete":if(c.fire===se)break;return o._promise("readwrite",function(){return g(i)},!0);case"deleteRange":if(c.fire===se)break;return o._promise("readwrite",function(){return function f(b,p,v){return n.query({trans:b,values:!1,query:{index:r,range:p},limit:v}).then(function(_){var y=_.result;return g({type:"delete",keys:y,trans:b}).then(function(P){return 0<P.numFailures?Promise.reject(P.failures[0]):y.length<v?{failures:[],numFailures:0,lastResult:void 0}:f(b,s(s({},p),{lower:y[y.length-1],lowerOpen:!0}),v)})})}(i.trans,i.range,1e4)},!0)}return n.mutate(i);function g(f){var b,p,v,_=U.trans,y=f.keys||gr(r,f);if(!y)throw new Error("Keys missing");return(f=f.type==="add"||f.type==="put"?s(s({},f),{keys:y}):s({},f)).type!=="delete"&&(f.values=k([],f.values)),f.keys&&(f.keys=k([],f.keys)),b=n,v=y,((p=f).type==="add"?Promise.resolve([]):b.getMany({trans:p.trans,keys:v,cache:"immutable"})).then(function(P){var S=y.map(function(C,K){var I,B,j,R=P[K],N={onerror:null,onsuccess:null};return f.type==="delete"?c.fire.call(N,C,R,_):f.type==="add"||R===void 0?(I=m.fire.call(N,C,f.values[K],_),C==null&&I!=null&&(f.keys[K]=C=I,r.outbound||z(f.values[K],r.keyPath,C))):(I=vr(R,f.values[K]),(B=h.fire.call(N,I,C,R,_))&&(j=f.values[K],Object.keys(B).forEach(function(A){M(j,A)?j[A]=B[A]:z(j,A,B[A])}))),N});return n.mutate(f).then(function(C){for(var K=C.failures,I=C.results,B=C.numFailures,C=C.lastResult,j=0;j<y.length;++j){var R=(I||y)[j],N=S[j];R==null?N.onerror&&N.onerror(K[j]):N.onsuccess&&N.onsuccess(f.type==="put"&&P[j]?f.values[j]:R)}return{failures:K,results:I,numFailures:B,lastResult:C}}).catch(function(C){return S.forEach(function(K){return K.onerror&&K.onerror(C)}),Promise.reject(C)})})}}})}})}};function Jr(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)re(t.keys[i],e[o])===0&&(r.push(n?ge(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch{return null}}var ho={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return s(s({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Jr(r.keys,r.trans._cache,r.cache==="clone");return i?F.resolve(i):n.getMany(r).then(function(o){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?ge(o):o},o})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function ei(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function ti(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var po={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new qe(e.MIN_KEY,e.MAX_KEY);return s(s({},e),{transaction:function(r,i,o){if(U.subscr&&i!=="readonly")throw new L.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(U.querier));return e.transaction(r,i,o)},table:function(r){var i=e.table(r),o=i.schema,u=o.primaryKey,f=o.indexes,c=u.extractKey,m=u.outbound,h=u.autoIncrement&&f.filter(function(p){return p.compound&&p.keyPath.includes(u.keyPath)}),g=s(s({},i),{mutate:function(p){function v(A){return A="idb://".concat(t,"/").concat(r,"/").concat(A),C[A]||(C[A]=new qe)}var _,y,P,S=p.trans,C=p.mutatedParts||(p.mutatedParts={}),K=v(""),I=v(":dels"),B=p.type,N=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[gr(u,p).filter(function(A){return A}),p.values]:[],j=N[0],R=N[1],N=p.trans._cache;return x(j)?(K.addKeys(j),(N=B==="delete"||j.length===R.length?Jr(j,N):null)||I.addKeys(j),(N||R)&&(_=v,y=N,P=R,o.indexes.forEach(function(A){var H=_(A.name||"");function Q(J){return J!=null?A.extractKey(J):null}function ne(J){return A.multiEntry&&x(J)?J.forEach(function(Ve){return H.addKey(Ve)}):H.addKey(J)}(y||P).forEach(function(J,Ce){var ee=y&&Q(y[Ce]),Ce=P&&Q(P[Ce]);re(ee,Ce)!==0&&(ee!=null&&ne(ee),Ce!=null&&ne(Ce))})}))):j?(R={from:j.lower,to:j.upper},I.add(R),K.add(R)):(K.add(n),I.add(n),o.indexes.forEach(function(A){return v(A.name).add(n)})),i.mutate(p).then(function(A){return!j||p.type!=="add"&&p.type!=="put"||(K.addKeys(A.results),h&&h.forEach(function(H){var Q=p.values.map(function(J){return H.extractKey(J)}),ne=H.keyPath.findIndex(function(J){return J===u.keyPath});A.results.forEach(function(J){return Q[ne]=J}),v(H.name).addKeys(Q)})),S.mutatedParts=Dn(S.mutatedParts||{},C),A})}}),f=function(v){var _=v.query,v=_.index,_=_.range;return[v,new qe((v=_.lower)!==null&&v!==void 0?v:e.MIN_KEY,(_=_.upper)!==null&&_!==void 0?_:e.MAX_KEY)]},b={get:function(p){return[u,new qe(p.key)]},getMany:function(p){return[u,new qe().addKeys(p.keys)]},count:f,query:f,openCursor:f};return O(b).forEach(function(p){g[p]=function(v){var _=U.subscr,y=!!_,P=ei(U,i)&&ti(p,v)?v.obsSet={}:_;if(y){var S=function(R){return R="idb://".concat(t,"/").concat(r,"/").concat(R),P[R]||(P[R]=new qe)},C=S(""),K=S(":dels"),_=b[p](v),y=_[0],_=_[1];if((p==="query"&&y.isPrimaryKey&&!v.values?K:S(y.name||"")).add(_),!y.isPrimaryKey){if(p!=="count"){var I=p==="query"&&m&&v.values&&i.query(s(s({},v),{values:!1}));return i[p].apply(this,arguments).then(function(R){if(p==="query"){if(m&&v.values)return I.then(function(Q){return Q=Q.result,C.addKeys(Q),R});var N=v.values?R.result.map(c):R.result;(v.values?C:K).addKeys(N)}else if(p==="openCursor"){var A=R,H=v.values;return A&&Object.create(A,{key:{get:function(){return K.addKey(A.primaryKey),A.key}},primaryKey:{get:function(){var Q=A.primaryKey;return K.addKey(Q),Q}},value:{get:function(){return H&&C.addKey(A.primaryKey),A.value}}})}return R})}K.add(n)}}return i[p].apply(this,arguments)}}),g}})}};function ni(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=s({},t),x(t.keys)&&(t.keys=t.keys.filter(function(i,o){return!(o in n.failures)})),"values"in t&&x(t.values)&&(t.values=t.values.filter(function(i,o){return!(o in n.failures)})),t)}function br(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<re(n,r.lower):0<=re(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?re(e,t.upper)<0:re(e,t.upper)<=0));var n,r}function ri(e,t,b,r,i,o){if(!b||b.length===0)return e;var u=t.query.index,c=u.multiEntry,m=t.query.range,h=r.schema.primaryKey.extractKey,g=u.extractKey,f=(u.lowLevelIndex||u).extractKey,b=b.reduce(function(p,v){var _=p,y=[];if(v.type==="add"||v.type==="put")for(var P=new qe,S=v.values.length-1;0<=S;--S){var C,K=v.values[S],I=h(K);P.hasKey(I)||(C=g(K),(c&&x(C)?C.some(function(N){return br(N,m)}):br(C,m))&&(P.addKey(I),y.push(K)))}switch(v.type){case"add":_=p.concat(t.values?y:y.map(function(A){return h(A)}));break;case"put":var B=new qe().addKeys(v.values.map(function(A){return h(A)})),_=p.filter(function(A){return!B.hasKey(t.values?h(A):A)}).concat(t.values?y:y.map(function(A){return h(A)}));break;case"delete":var j=new qe().addKeys(v.keys);_=p.filter(function(A){return!j.hasKey(t.values?h(A):A)});break;case"deleteRange":var R=v.range;_=p.filter(function(A){return!br(h(A),R)})}return _},e);return b===e?e:(b.sort(function(p,v){return re(f(p),f(v))||re(h(p),h(v))}),t.limit&&t.limit<1/0&&(b.length>t.limit?b.length=t.limit:e.length===t.limit&&b.length<t.limit&&(i.dirty=!0)),o?Object.freeze(b):b)}function ii(e,t){return re(e.lower,t.lower)===0&&re(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function mo(e,t){return function(n,r,i,o){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=re(n,r))===0){if(i&&o)return 0;if(i)return 1;if(o)return-1}return r}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,r,i,o){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=re(n,r))===0){if(i&&o)return 0;if(i)return-1;if(o)return 1}return r}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function yo(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var i,o;e.subscribers.delete(n),e.subscribers.size===0&&(i=e,o=t,setTimeout(function(){i.subscribers.size===0&&We(o,i)},3e3))})}var vo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return s(s({},e),{transaction:function(n,r,i){var o,u,c=e.transaction(n,r,i);return r==="readwrite"&&(u=(o=new AbortController).signal,i=function(m){return function(){if(o.abort(),r==="readwrite"){for(var h=new Set,g=0,f=n;g<f.length;g++){var b=f[g],p=vt["idb://".concat(t,"/").concat(b)];if(p){var v=e.table(b),_=p.optimisticOps.filter(function(H){return H.trans===c});if(c._explicit&&m&&c.mutatedParts)for(var y=0,P=Object.values(p.queries.query);y<P.length;y++)for(var S=0,C=(B=P[y]).slice();S<C.length;S++)hr((j=C[S]).obsSet,c.mutatedParts)&&(We(B,j),j.subscribers.forEach(function(H){return h.add(H)}));else if(0<_.length){p.optimisticOps=p.optimisticOps.filter(function(H){return H.trans!==c});for(var K=0,I=Object.values(p.queries.query);K<I.length;K++)for(var B,j,R,N=0,A=(B=I[K]).slice();N<A.length;N++)(j=A[N]).res!=null&&c.mutatedParts&&(m&&!j.dirty?(R=Object.isFrozen(j.res),R=ri(j.res,j.req,_,v,j,R),j.dirty?(We(B,j),j.subscribers.forEach(function(H){return h.add(H)})):R!==j.res&&(j.res=R,j.promise=F.resolve({result:R}))):(j.dirty&&We(B,j),j.subscribers.forEach(function(H){return h.add(H)})))}}}h.forEach(function(H){return H()})}}},c.addEventListener("abort",i(!1),{signal:u}),c.addEventListener("error",i(!1),{signal:u}),c.addEventListener("complete",i(!0),{signal:u})),c},table:function(n){var r=e.table(n),i=r.schema.primaryKey;return s(s({},r),{mutate:function(o){var u=U.trans;if(i.outbound||u.db._options.cache==="disabled"||u.explicit)return r.mutate(o);var c=vt["idb://".concat(t,"/").concat(n)];return c?(u=r.mutate(o),o.type!=="add"&&o.type!=="put"||!(50<=o.values.length||gr(i,o).some(function(m){return m==null}))?(c.optimisticOps.push(o),o.mutatedParts&&An(o.mutatedParts),u.then(function(m){0<m.numFailures&&(We(c.optimisticOps,o),(m=ni(0,o,m))&&c.optimisticOps.push(m),o.mutatedParts&&An(o.mutatedParts))}),u.catch(function(){We(c.optimisticOps,o),o.mutatedParts&&An(o.mutatedParts)})):u.then(function(m){var h=ni(0,s(s({},o),{values:o.values.map(function(p,f){var b,p=(b=i.keyPath)!==null&&b!==void 0&&b.includes(".")?ge(p):s({},p);return z(p,i.keyPath,m.results[f]),p})}),m);c.optimisticOps.push(h),queueMicrotask(function(){return o.mutatedParts&&An(o.mutatedParts)})}),u):r.mutate(o)},query:function(o){if(!ei(U,r)||!ti("query",o))return r.query(o);var u=((h=U.trans)===null||h===void 0?void 0:h.db._options.cache)==="immutable",f=U,c=f.requery,m=f.signal,h=function(v,_,y,P){var S=vt["idb://".concat(v,"/").concat(_)];if(!S)return[];if(!(_=S.queries[y]))return[null,!1,S,null];var C=_[(P.query?P.query.index.name:null)||""];if(!C)return[null,!1,S,null];switch(y){case"query":var K=C.find(function(I){return I.req.limit===P.limit&&I.req.values===P.values&&ii(I.req.query.range,P.query.range)});return K?[K,!0,S,C]:[C.find(function(I){return("limit"in I.req?I.req.limit:1/0)>=P.limit&&(!P.values||I.req.values)&&mo(I.req.query.range,P.query.range)}),!1,S,C];case"count":return K=C.find(function(I){return ii(I.req.query.range,P.query.range)}),[K,!!K,S,C]}}(t,n,"query",o),g=h[0],f=h[1],b=h[2],p=h[3];return g&&f?g.obsSet=o.obsSet:(f=r.query(o).then(function(v){var _=v.result;if(g&&(g.res=_),u){for(var y=0,P=_.length;y<P;++y)Object.freeze(_[y]);Object.freeze(_)}else v.result=ge(_);return v}).catch(function(v){return p&&g&&We(p,g),Promise.reject(v)}),g={obsSet:o.obsSet,promise:f,subscribers:new Set,type:"query",req:o,dirty:!1},p?p.push(g):(p=[g],(b=b||(vt["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[o.query.index.name||""]=p)),yo(g,p,c,m),g.promise.then(function(v){return{result:ri(v.result,o,b==null?void 0:b.optimisticOps,r,g,u)}})}})}})}};function jn(e,t){return new Proxy(e,{get:function(n,r,i){return r==="db"?t:Reflect.get(n,r,i)}})}var et=(_e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new L.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new L.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(oo),n.stores({}),this._state.autoSchema=!1,n)},_e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||U.letThrough||this._vip)?e():new F(function(n,r){if(t._state.openComplete)return r(new L.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new L.DatabaseClosed);t.open().catch(se)}t._state.dbReadyPromise.then(n,r)}).then(e)},_e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;return i&&this.unuse({stack:t,name:i}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:i}),e.sort(function(o,u){return o.level-u.level}),this},_e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(i){return r?i.create!==r:!!n&&i.name!==n})),this},_e.prototype.open=function(){var e=this;return pt(nt,function(){return co(e)})},_e.prototype._close=function(){var e=this._state,t=Tt.indexOf(this);if(0<=t&&Tt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new F(function(n){e.dbReadyResolve=n}),e.openCanceller=new F(function(n,r){e.cancelOpen=r}))},_e.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new L.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new L.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},_e.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new F(function(i,o){function u(){t.close(e);var c=t._deps.indexedDB.deleteDatabase(t.name);c.onsuccess=pe(function(){var m,h,g;m=t._deps,h=t.name,g=m.indexedDB,m=m.IDBKeyRange,cr(g)||h===gn||sr(g,m).delete(h).catch(se),i()}),c.onerror=He(o),c.onblocked=t._fireOnBlocked}if(n)throw new L.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(u):u()})},_e.prototype.backendDB=function(){return this.idbdb},_e.prototype.isOpen=function(){return this.idbdb!==null},_e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},_e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},_e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(_e.prototype,"tables",{get:function(){var e=this;return O(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),_e.prototype.transaction=function(){var e=(function(t,n,r){var i=arguments.length;if(i<2)throw new L.InvalidArgument("Too few arguments");for(var o=new Array(i-1);--i;)o[i-1]=arguments[i];return r=o.pop(),[t,Pe(o),r]}).apply(this,arguments);return this._transaction.apply(this,e)},_e.prototype._transaction=function(e,t,n){var r=this,i=U.trans;i&&i.db===this&&e.indexOf("!")===-1||(i=null);var o,u,c=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(u=t.map(function(h){if(h=h instanceof r.Table?h.name:h,typeof h!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return h}),e=="r"||e===Qn)o=Qn;else{if(e!="rw"&&e!=Xn)throw new L.InvalidArgument("Invalid transaction mode: "+e);o=Xn}if(i){if(i.mode===Qn&&o===Xn){if(!c)throw new L.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&u.forEach(function(h){if(i&&i.storeNames.indexOf(h)===-1){if(!c)throw new L.SubTransaction("Table "+h+" not included in parent transaction.");i=null}}),c&&i&&!i.active&&(i=null)}}catch(h){return i?i._promise(null,function(g,f){f(h)}):be(h)}var m=(function h(g,f,b,p,v){return F.resolve().then(function(){var _=U.transless||U,y=g._createTransaction(f,b,g._dbSchema,p);if(y.explicit=!0,_={trans:y,transless:_},p)y.idbtrans=p.idbtrans;else try{y.create(),y.idbtrans._explicit=!0,g._state.PR1398_maxLoop=3}catch(C){return C.name===Mn.InvalidState&&g.isOpen()&&0<--g._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),g.close({disableAutoOpen:!1}),g.open().then(function(){return h(g,f,b,null,v)})):be(C)}var P,S=Fn(v);return S&&jt(),_=F.follow(function(){var C;(P=v.call(y,y))&&(S?(C=it.bind(null,null),P.then(C,C)):typeof P.next=="function"&&typeof P.throw=="function"&&(P=yr(P)))},_),(P&&typeof P.then=="function"?F.resolve(P).then(function(C){return y.active?C:be(new L.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):_.then(function(){return P})).then(function(C){return p&&y._resolve(),y._completion.then(function(){return C})}).catch(function(C){return y._reject(C),be(C)})})}).bind(null,this,o,u,i,n);return i?i._promise(o,m,"lock"):U.trans?pt(U.transless,function(){return r._whenReady(m)}):this._whenReady(m)},_e.prototype.table=function(e){if(!M(this._allTables,e))throw new L.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},_e);function _e(e,t){var n=this;this._middlewares={},this.verno=0;var r=_e.dependencies;this._options=t=s({addons:_e.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},r=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var i,o,u,c,m,h={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:se,dbReadyPromise:null,cancelOpen:se,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};h.dbReadyPromise=new F(function(f){h.dbReadyResolve=f}),h.openCanceller=new F(function(f,b){h.cancelOpen=b}),this._state=h,this.name=e,this.on=Gt(this,"populate","blocked","versionchange","close",{ready:[Un,se]}),this.on.ready.subscribe=Z(this.on.ready.subscribe,function(f){return function(b,p){_e.vip(function(){var v,_=n._state;_.openComplete?(_.dbOpenError||F.resolve().then(b),p&&f(b)):_.onReadyBeingFired?(_.onReadyBeingFired.push(b),p&&f(b)):(f(b),v=n,p||f(function y(){v.on.ready.unsubscribe(b),v.on.ready.unsubscribe(y)}))})}}),this.Collection=(i=this,Qt(Zi.prototype,function(P,y){this.db=i;var p=Rr,v=null;if(y)try{p=y()}catch(S){v=S}var _=P._ctx,y=_.table,P=y.hook.reading.fire;this._ctx={table:y,index:_.index,isPrimKey:!_.index||y.schema.primKey.keyPath&&_.index===y.schema.primKey.name,range:p,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:v,or:_.or,valueMapper:P!==Vt?P:null}})),this.Table=(o=this,Qt(Fr.prototype,function(f,b,p){this.db=o,this._tx=p,this.name=f,this.schema=b,this.hook=o._allTables[f]?o._allTables[f].hook:Gt(null,{creating:[Vi,se],reading:[Li,Vt],updating:[Yi,se],deleting:[zi,se]})})),this.Transaction=(u=this,Qt(to.prototype,function(f,b,p,v,_){var y=this;this.db=u,this.mode=f,this.storeNames=b,this.schema=p,this.chromeTransactionDurability=v,this.idbtrans=null,this.on=Gt(this,"complete","error","abort"),this.parent=_||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new F(function(P,S){y._resolve=P,y._reject=S}),this._completion.then(function(){y.active=!1,y.on.complete.fire()},function(P){var S=y.active;return y.active=!1,y.on.error.fire(P),y.parent?y.parent._reject(P):S&&y.idbtrans&&y.idbtrans.abort(),be(P)})})),this.Version=(c=this,Qt(so.prototype,function(f){this.db=c,this._cfg={version:f,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(m=this,Qt(zr.prototype,function(f,b,p){if(this.db=m,this._ctx={table:f,index:b===":id"?null:b,or:p},this._cmp=this._ascending=re,this._descending=function(v,_){return re(_,v)},this._max=function(v,_){return 0<re(v,_)?v:_},this._min=function(v,_){return re(v,_)<0?v:_},this._IDBKeyRange=m._deps.IDBKeyRange,!this._IDBKeyRange)throw new L.MissingAPI})),this.on("versionchange",function(f){0<f.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(f){!f.newVersion||f.newVersion<f.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(f.oldVersion/10))}),this._maxKey=en(t.IDBKeyRange),this._createTransaction=function(f,b,p,v){return new n.Transaction(f,b,p,n._options.chromeTransactionDurability,v)},this._fireOnBlocked=function(f){n.on("blocked").fire(f),Tt.filter(function(b){return b.name===n.name&&b!==n&&!b._state.vcFired}).map(function(b){return b.on("versionchange").fire(f)})},this.use(ho),this.use(vo),this.use(po),this.use(lo),this.use(fo);var g=new Proxy(this,{get:function(f,b,p){if(b==="_vip")return!0;if(b==="table")return function(_){return jn(n.table(_),g)};var v=Reflect.get(f,b,p);return v instanceof Fr?jn(v,g):b==="tables"?v.map(function(_){return jn(_,g)}):b==="_createTransaction"?function(){return jn(v.apply(this,arguments),g)}:v}});this.vip=g,r.forEach(function(f){return f(n)})}var Tn,Ue=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",go=(_r.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},_r.prototype[Ue]=function(){return this},_r);function _r(e){this._subscribe=e}try{Tn={indexedDB:w.indexedDB||w.mozIndexedDB||w.webkitIndexedDB||w.msIndexedDB,IDBKeyRange:w.IDBKeyRange||w.webkitIDBKeyRange}}catch{Tn={indexedDB:null,IDBKeyRange:null}}function oi(e){var t,n=!1,r=new go(function(i){var o=Fn(e),u,c=!1,m={},h={},g={get closed(){return c},unsubscribe:function(){c||(c=!0,u&&u.abort(),f&&ut.storagemutated.unsubscribe(p))}};i.start&&i.start(g);var f=!1,b=function(){return Gn(v)},p=function(_){Dn(m,_),hr(h,m)&&b()},v=function(){var _,y,P;!c&&Tn.indexedDB&&(m={},_={},u&&u.abort(),u=new AbortController,P=function(S){var C=At();try{o&&jt();var K=rt(e,S);return K=o?K.finally(it):K}finally{C&&It()}}(y={subscr:_,signal:u.signal,requery:b,querier:e,trans:null}),Promise.resolve(P).then(function(S){n=!0,t=S,c||y.signal.aborted||(m={},function(C){for(var K in C)if(M(C,K))return;return 1}(h=_)||f||(ut(Jt,p),f=!0),Gn(function(){return!c&&i.next&&i.next(S)}))},function(S){n=!1,["DatabaseClosedError","AbortError"].includes(S==null?void 0:S.name)||c||Gn(function(){c||i.error&&i.error(S)})}))};return setTimeout(b,0),g});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var gt=et;function wr(e){var t=st;try{st=!0,ut.storagemutated.fire(e),mr(e,!0)}finally{st=t}}oe(gt,s(s({},cn),{delete:function(e){return new gt(e,{addons:[]}).delete()},exists:function(e){return new gt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=gt.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(cr(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==gn})}):sr(n,t).toCollection().primaryKeys()).then(e)}catch{return be(new L.MissingAPI)}var t,n},defineClass:function(){return function(e){E(this,e)}},ignoreTransaction:function(e){return U.trans?pt(U.transless,e):e()},vip:lr,async:function(e){return function(){try{var t=yr(e.apply(this,arguments));return t&&typeof t.then=="function"?t:F.resolve(t)}catch(n){return be(n)}}},spawn:function(e,t,n){try{var r=yr(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:F.resolve(r)}catch(i){return be(i)}},currentTransaction:{get:function(){return U.trans||null}},waitFor:function(e,t){return t=F.resolve(typeof e=="function"?gt.ignoreTransaction(e):e).timeout(t||6e4),U.trans?U.trans.waitFor(t):t},Promise:F,debug:{get:function(){return $e},set:function(e){Cr(e)}},derive:ye,extend:E,props:oe,override:Z,Events:Gt,on:ut,liveQuery:oi,extendObservabilitySet:Dn,getByKeyPath:Y,setByKeyPath:z,delByKeyPath:function(e,t){typeof t=="string"?z(e,t,void 0):"length"in t&&[].map.call(t,function(n){z(e,n,void 0)})},shallowClone:ae,deepClone:ge,getObjectDiff:vr,cmp:re,asap:q,minKey:-1/0,addons:[],connections:Tt,errnames:Mn,dependencies:Tn,cache:vt,semVer:"4.0.8",version:"4.0.8".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),gt.maxKey=en(gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ut(Jt,function(e){st||(e=new CustomEvent(tr,{detail:e}),st=!0,dispatchEvent(e),st=!1)}),addEventListener(tr,function(e){e=e.detail,st||wr(e)}));var qt,st=!1,ai=function(){};return typeof BroadcastChannel<"u"&&((ai=function(){(qt=new BroadcastChannel(tr)).onmessage=function(e){return e.data&&wr(e.data)}})(),typeof qt.unref=="function"&&qt.unref(),ut(Jt,function(e){st||qt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!et.disableBfCache&&e.persisted){$e&&console.debug("Dexie: handling persisted pagehide"),qt!=null&&qt.close();for(var t=0,n=Tt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!et.disableBfCache&&e.persisted&&($e&&console.debug("Dexie: handling persisted pageshow"),ai(),wr({all:new qe(-1/0,[[]])}))})),F.rejectionMapper=function(e,t){return!e||e instanceof Kt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Sr[e.name]?e:(t=new Sr[e.name](t||e.message,e),"stack"in e&&X(t,"stack",{get:function(){return this.inner.stack}}),t)},Cr($e),s(et,Object.freeze({__proto__:null,Dexie:et,liveQuery:oi,Entity:Br,cmp:re,PropModSymbol:Je,PropModification:Xt,replacePrefix:function(e,t){return new Xt({replacePrefix:[e,t]})},add:function(e){return new Xt({add:e})},remove:function(e){return new Xt({remove:e})},default:et,RangeSet:qe,mergeRanges:rn,rangesOverlap:Gr}),{default:et}),et})})(Ri);var Ao=Ri.exports;const xr=Eo(Ao),hi=Symbol.for("Dexie"),Nn=globalThis[hi]||(globalThis[hi]=xr);if(xr.semVer!==Nn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${xr.semVer} and ${Nn.semVer}`);const{liveQuery:di,mergeRanges:sa,rangesOverlap:ca,RangeSet:la,cmp:fa,Entity:ha,PropModSymbol:da,PropModification:pa,replacePrefix:ma,add:ya,remove:va}=Nn,ze=new Nn("TradingDatabase");ze.version(2).stores({prices:"id++, [classid+currency], lowest_price, median_price, success, createdAt",badges:"id++, appid, numberOfCards, createdAt"}).upgrade(d=>d.table("prices").toCollection().delete());ze.version(1).stores({prices:"id++, [classid+currency], lowest_price, median_price, success"});const Bi="20",Pr={1:{label:"USD",long:"United States Dollar"},2:{label:"GBP",long:"United Kingdom Pound"},3:{label:"EUR",long:"European Union Euro"},4:{label:"CHF",long:"Swiss Francs"},5:{label:"RUB",long:"Russian Rouble"},6:{label:"PLN",long:"Polish Złoty"},7:{label:"BRL",long:"Brazilian Reals"},8:{label:"JPY",long:"Japanese Yen"},9:{label:"NOK",long:"Norwegian Krone"},10:{label:"IDR",long:"Indonesian Rupiah"},11:{label:"MYR",long:"Malaysian Ringgit"},12:{label:"PHP",long:"Philippine Peso"},13:{label:"SGD",long:"Singapore Dollar"},14:{label:"THB",long:"Thai Baht"},15:{label:"VND",long:"Vietnamese Dong"},16:{label:"KRW",long:"South Korean Won"},18:{label:"UAH",long:"Ukrainian Hryvnia"},19:{label:"MXN",long:"Mexican Peso"},20:{label:"CAD",long:"Canadian Dollars"},21:{label:"AUD",long:"Australian Dollars"},22:{label:"NZD",long:"New Zealand Dollar"},23:{label:"CNY",long:"Chinese Renminbi (yuan)"},24:{label:"INR",long:"Indian Rupee"},25:{label:"CLP",long:"Chilean Peso"},26:{label:"PEN",long:"Peruvian Sol"},27:{label:"COP",long:"Colombian Peso"},28:{label:"ZAR",long:"South African Rand"},29:{label:"HKD",long:"Hong Kong Dollar"},30:{label:"TWD",long:"New Taiwan Dollar"},31:{label:"SAR",long:"Saudi Riyal"},32:{label:"AED",long:"United Arab Emirates Dirham"},35:{label:"ILS",long:"Israeli New Shekel"},37:{label:"KZT",long:"Kazakhstani Tenge"},38:{label:"KWD",long:"Kuwaiti Dinar"},39:{label:"QAR",long:"Qatari Riyal"},40:{label:"CRC",long:"Costa Rican Colón"},41:{label:"UYU",long:"Uruguayan Peso"}},lt="753",pi={753:{label:"Steam",context:6},730:{label:"Counter Strike",context:2}},Lt=Ti([]),qi=Ti(""),Io=(d,a,l)=>{const s=x=>x.reduce((E,D)=>{const{classid:T}=D;return E[T]=(E[T]||0)+1,E},{}),k=(x,E)=>{const D=E.find(T=>T.classid===x);return D||null},w=s(d);let O=Object.entries(w).map(([x,E])=>{const D=k(x,a);return{card:{count:E,description:D},numberSelected:0}});l==lt&&(O=O.filter(x=>x.card.description?x.card.description.tags.some(E=>E.localized_tag_name==="Trading Card"):!0)),Lt.set(O)},jo=Or([Lt,qi],([d,a])=>d.filter(l=>a===""?!0:l.card.description?l.card.description.name.toLowerCase().includes(a.toLowerCase())||l.card.description.type.toLowerCase().includes(a.toLowerCase()):!1).sort((l,s)=>!l.card.description||!s.card.description?0:l.card.description.type.localeCompare(s.card.description.type))),Ni=Or(Lt,d=>d.filter(a=>a.numberSelected>0).sort((a,l)=>!a.card.description||!l.card.description?0:a.card.description.type.localeCompare(l.card.description.type))),To=Or(Ni,d=>async a=>{let l=0;for(const s of d){let k=await ze.prices.where({classid:+s.card.description.classid,currency:a}).first();if(k==null||!k.lowest_price&&!k.median_price)return"???";let O=(k.lowest_price?k.lowest_price:k.median_price).match(/[\d.,]+/);if(!O)return"???";let x=parseFloat(O[0].replace(",","."));l+=x*s.numberSelected}return Math.floor(l*100)/100}),Ro=d=>{Lt.update(a=>{if(d.description==null)return a;let l=a.findIndex(s=>{var k,w;return((k=s.card.description)==null?void 0:k.classid)===((w=d.description)==null?void 0:w.classid)});return l===-1||a[l].numberSelected+1>d.count||(a[l].numberSelected+=1),a})},Bo=d=>{Lt.update(a=>{if(d.description==null)return a;let l=a.findIndex(s=>{var k,w;return((k=s.card.description)==null?void 0:k.classid)===((w=d.description)==null?void 0:w.classid)});return l===-1||(a[l].numberSelected-1>0?a[l].numberSelected-=1:a[l].numberSelected=0),a})};function mi(d){var Y,z,ae,te,Pe;let a,l,s,k,w,O,x,E,D,T=(d[7]?((Y=d[7])==null?void 0:Y.lowest_price)||((z=d[7])==null?void 0:z.median_price)||"N/A":"?")+"",M,oe,ue,X=((ae=d[4].description)==null?void 0:ae.name)+"",ye,we,ke,fe,Z,V;s=new Do({props:{src:`https://community.akamai.steamstatic.com/economy/image/${(te=d[4].description)==null?void 0:te.icon_url}/128fx128f`,name:((Pe=d[4].description)==null?void 0:Pe.name)||""}});let q=d[3]&&yi(d);return{c(){a=ce("button"),l=ce("div"),wt(s.$$.fragment),k=De(),q&&q.c(),w=De(),O=ce("span"),x=je(d[0]),E=De(),D=ce("div"),M=je(T),oe=De(),ue=ce("div"),ye=je(X),we=je(" - "),ke=je(d[5]),this.h()},l(Se){a=le(Se,"BUTTON",{class:!0,tabindex:!0});var he=me(a);l=le(he,"DIV",{class:!0});var ge=me(l);kt(s.$$.fragment,ge),k=Ae(ge),q&&q.l(ge),w=Ae(ge),O=le(ge,"SPAN",{class:!0});var Ye=me(O);x=Te(Ye,d[0]),Ye.forEach(W),ge.forEach(W),E=Ae(he),D=le(he,"DIV",{class:!0,role:!0});var Me=me(D);M=Te(Me,T),Me.forEach(W),oe=Ae(he),ue=le(he,"DIV",{class:!0});var Be=me(ue);ye=Te(Be,X),we=Te(Be," - "),ke=Te(Be,d[5]),Be.forEach(W),he.forEach(W),this.h()},h(){G(O,"class","absolute top-0 right-0 transform -translate-y-1/2 bg-red-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center"),G(l,"class","relative"),G(D,"class","w-full text-center"),G(D,"role","banner"),G(ue,"class","w-32 text-xs break-words text-center"),G(a,"class","flex flex-col items-center"),G(a,"tabindex","0")},m(Se,he){ve(Se,a,he),$(a,l),xt(s,l,null),$(l,k),q&&q.m(l,null),$(l,w),$(l,O),$(O,x),$(a,E),$(a,D),$(D,M),$(a,oe),$(a,ue),$(ue,ye),$(ue,we),$(ue,ke),fe=!0,Z||(V=[Le(D,"mouseover",d[10]),Le(D,"focus",d[10]),Le(a,"click",function(){xo(d[1])&&d[1].apply(this,arguments)})],Z=!0)},p(Se,he){var Ye,Me,Be,tt,We;d=Se;const ge={};he&16&&(ge.src=`https://community.akamai.steamstatic.com/economy/image/${(Ye=d[4].description)==null?void 0:Ye.icon_url}/128fx128f`),he&16&&(ge.name=((Me=d[4].description)==null?void 0:Me.name)||""),s.$set(ge),d[3]?q?q.p(d,he):(q=yi(d),q.c(),q.m(l,w)):q&&(q.d(1),q=null),(!fe||he&1)&&_t(x,d[0]),(!fe||he&128)&&T!==(T=(d[7]?((Be=d[7])==null?void 0:Be.lowest_price)||((tt=d[7])==null?void 0:tt.median_price)||"N/A":"?")+"")&&_t(M,T),(!fe||he&16)&&X!==(X=((We=d[4].description)==null?void 0:We.name)+"")&&_t(ye,X),(!fe||he&32)&&_t(ke,d[5])},i(Se){fe||(xe(s.$$.fragment,Se),fe=!0)},o(Se){Re(s.$$.fragment,Se),fe=!1},d(Se){Se&&W(a),Pt(s),q&&q.d(),Z=!1,an(V)}}}function yi(d){var O;let a,l=(((O=d[6])==null?void 0:O.numberOfCards)||"-1")+"",s,k,w;return{c(){a=ce("span"),s=je(l),this.h()},l(x){a=le(x,"SPAN",{role:!0,class:!0});var E=me(a);s=Te(E,l),E.forEach(W),this.h()},h(){G(a,"role","banner"),G(a,"class","absolute top-0 left-0 transform -translate-y-1/2 bg-blue-500 text-white text-xs font-bold rounded-full w-6 h-6 flex items-center justify-center")},m(x,E){ve(x,a,E),$(a,s),k||(w=[Le(a,"mouseover",d[11]),Le(a,"focus",d[11])],k=!0)},p(x,E){var D;E&64&&l!==(l=(((D=x[6])==null?void 0:D.numberOfCards)||"-1")+"")&&_t(s,l)},d(x){x&&W(a),k=!1,an(w)}}}function qo(d){let a,l,s=d[4]&&d[2]&&mi(d);return{c(){s&&s.c(),a=Qe()},l(k){s&&s.l(k),a=Qe()},m(k,w){s&&s.m(k,w),ve(k,a,w),l=!0},p(k,[w]){k[4]&&k[2]?s?(s.p(k,w),w&20&&xe(s,1)):(s=mi(k),s.c(),xe(s,1),s.m(a.parentNode,a)):s&&(Mt(),Re(s,1,1,()=>{s=null}),Ut())},i(k){l||(xe(s),l=!0)},o(k){Re(s),l=!1},d(k){k&&W(a),s&&s.d(k)}}}function No(d,a,l){let s,k,w,O,x;Nt(d,Lt,Z=>l(14,w=Z));let{count:E}=a,{classid:D}=a,{appid:T}=a,{onClick:M}=a,{currency:oe}=a,{showBadges:ue}=a,X=di(()=>ze.prices.where({classid:D,currency:oe}).first());Nt(d,X,Z=>l(7,x=Z));let ye=di(()=>ze.badges.where({appid:T}).first());Nt(d,ye,Z=>l(6,O=Z));const we=Z=>{if(Z==null||Z.description==null)return;let V=Z.description.type;return V=V.replace("Trading Card",""),V=V.replace("Foil",""),V},ke=async()=>{if(s==null||s.description==null||await ze.prices.where({classid:+s.description.classid,currency:oe}).first()!=null)return;let V=`/market?market_hash_name=${encodeURIComponent(s.description.market_hash_name)}&currency=${oe}&appid=${s.description.appid}`,q=await fetch(V);if(q.status===429){Oo.error("Rate limited 😵‍💫, please try again later!");return}let Y=await q.json();await ze.prices.add({classid:+s.description.classid,lowest_price:Y.lowest_price,median_price:Y.median_price,success:Y.success,currency:+oe,createdAt:Date.now()})},fe=async()=>{if(s==null||s.description==null||await ze.badges.where({appid:s.description.market_fee_app}).first()!=null)return;let q=await(await fetch(`/badge?appid=${s.description.market_fee_app}`)).json();ze.badges.add({appid:s.description.market_fee_app,numberOfCards:q,createdAt:Date.now()})};return d.$$set=Z=>{"count"in Z&&l(0,E=Z.count),"classid"in Z&&l(12,D=Z.classid),"appid"in Z&&l(13,T=Z.appid),"onClick"in Z&&l(1,M=Z.onClick),"currency"in Z&&l(2,oe=Z.currency),"showBadges"in Z&&l(3,ue=Z.showBadges)},d.$$.update=()=>{var Z;d.$$.dirty&20480&&l(4,s=(Z=w.find(V=>{var q;return+((q=V.card.description)==null?void 0:q.classid)===D}))==null?void 0:Z.card),d.$$.dirty&16&&l(5,k=we(s))},[E,M,oe,ue,s,k,O,x,X,ye,ke,fe,D,T,w]}class Fi extends Et{constructor(a){super(),St(this,a,No,qo,Ot,{count:0,classid:12,appid:13,onClick:1,currency:2,showBadges:3})}}function vi(d,a,l){const s=d.slice();return s[8]=a[l],s}function Fo(d){return{c:Ie,l:Ie,m:Ie,p:Ie,d:Ie}}function Mo(d){let a,l,s=d[11]+"",k,w,O,x;return{c(){a=ce("span"),l=je("Selected Inventory ("),k=je(s),w=De(),O=je(d[1]),x=je(")"),this.h()},l(E){a=le(E,"SPAN",{class:!0});var D=me(a);l=Te(D,"Selected Inventory ("),k=Te(D,s),w=Ae(D),O=Te(D,d[1]),x=Te(D,")"),D.forEach(W),this.h()},h(){G(a,"class","font-bold")},m(E,D){ve(E,a,D),$(a,l),$(a,k),$(a,w),$(a,O),$(a,x)},p(E,D){D&20&&s!==(s=E[11]+"")&&_t(k,s),D&2&&_t(O,E[1])},d(E){E&&W(a)}}}function Uo(d){let a,l="Calculating...";return{c(){a=ce("p"),a.textContent=l},l(s){a=le(s,"P",{"data-svelte-h":!0}),un(a)!=="svelte-ml5145"&&(a.textContent=l)},m(s,k){ve(s,a,k)},p:Ie,d(s){s&&W(a)}}}function gi(d){let a;return{c(){a=je("No Cards")},l(l){a=Te(l,"No Cards")},m(l,s){ve(l,a,s)},d(l){l&&W(a)}}}function bi(d){let a,l;function s(){return d[7](d[8])}return a=new Fi({props:{classid:+d[8].card.description.classid,appid:+d[8].card.description.market_fee_app,currency:+d[2],count:d[8].numberSelected,onClick:s,showBadges:d[3]==lt}}),{c(){wt(a.$$.fragment)},l(k){kt(a.$$.fragment,k)},m(k,w){xt(a,k,w),l=!0},p(k,w){d=k;const O={};w&32&&(O.classid=+d[8].card.description.classid),w&32&&(O.appid=+d[8].card.description.market_fee_app),w&4&&(O.currency=+d[2]),w&32&&(O.count=d[8].numberSelected),w&32&&(O.onClick=s),w&8&&(O.showBadges=d[3]==lt),a.$set(O)},i(k){l||(xe(a.$$.fragment,k),l=!0)},o(k){Re(a.$$.fragment,k),l=!1},d(k){Pt(a,k)}}}function _i(d,a){let l,s,k,w=a[8].card.description&&bi(a);return{key:d,first:null,c(){l=Qe(),w&&w.c(),s=Qe(),this.h()},l(O){l=Qe(),w&&w.l(O),s=Qe(),this.h()},h(){this.first=l},m(O,x){ve(O,l,x),w&&w.m(O,x),ve(O,s,x),k=!0},p(O,x){a=O,a[8].card.description?w?(w.p(a,x),x&32&&xe(w,1)):(w=bi(a),w.c(),xe(w,1),w.m(s.parentNode,s)):w&&(Mt(),Re(w,1,1,()=>{w=null}),Ut())},i(O){k||(xe(w),k=!0)},o(O){Re(w),k=!1},d(O){O&&(W(l),W(s)),w&&w.d(O)}}}function Lo(d){let a,l,s,k,w,O,x,E,D,T,M,oe,ue,X=[],ye=new Map,we,ke,fe,Z,V={ctx:d,current:null,token:null,hasCatch:!1,pending:Uo,then:Mo,catch:Fo,value:11};fi(w=d[4](+d[2]),V);let q=ct(d[5]);const Y=ae=>{var te;return(te=ae[8].card.description)==null?void 0:te.classid};for(let ae=0;ae<q.length;ae+=1){let te=vi(d,q,ae),Pe=Y(te);ye.set(Pe,X[ae]=_i(Pe,te))}let z=null;return q.length||(z=gi()),{c(){a=ce("div"),l=ce("div"),s=ce("button"),k=ce("div"),V.block.c(),O=De(),x=si("svg"),E=si("path"),T=De(),M=ce("div"),oe=ce("div"),ue=ce("div");for(let ae=0;ae<X.length;ae+=1)X[ae].c();z&&z.c(),this.h()},l(ae){a=le(ae,"DIV",{class:!0});var te=me(a);l=le(te,"DIV",{class:!0});var Pe=me(l);s=le(Pe,"BUTTON",{class:!0});var Se=me(s);k=le(Se,"DIV",{class:!0});var he=me(k);V.block.l(he),O=Ae(he),x=ci(he,"svg",{class:!0,fill:!0,stroke:!0,viewBox:!0,xmlns:!0});var ge=me(x);E=ci(ge,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),me(E).forEach(W),ge.forEach(W),he.forEach(W),Se.forEach(W),T=Ae(Pe),M=le(Pe,"DIV",{class:!0});var Ye=me(M);oe=le(Ye,"DIV",{class:!0});var Me=me(oe);ue=le(Me,"DIV",{class:!0});var Be=me(ue);for(let tt=0;tt<X.length;tt+=1)X[tt].l(Be);z&&z.l(Be),Be.forEach(W),Me.forEach(W),Ye.forEach(W),Pe.forEach(W),te.forEach(W),this.h()},h(){G(E,"stroke-linecap","round"),G(E,"stroke-linejoin","round"),G(E,"stroke-width","2"),G(E,"d","M19 9l-7 7-7-7"),G(x,"class",D=`w-6 h-6 transform transition-transform duration-300 ${d[0]?"rotate-180":"rotate-0"}`),G(x,"fill","none"),G(x,"stroke","currentColor"),G(x,"viewBox","0 0 24 24"),G(x,"xmlns","http://www.w3.org/2000/svg"),G(k,"class","flex items-center justify-between"),G(s,"class","w-full p-4 text-left bg-neutral-600 hover:bg-neutral-700 focus:outline-none rounded-t-lg"),G(ue,"class","flex flex-wrap justify-center gap-4"),G(oe,"class","p-4"),G(M,"class",we=`transition-max-height duration-500 ease-in-out overflow-y-scroll ${d[0]?"max-h-96":"max-h-0"}`),G(l,"class","bg-neutral-500 shadow-lg rounded-t-lg"),G(a,"class","fixed bottom-0 left-0 w-full mx-auto text-white")},m(ae,te){ve(ae,a,te),$(a,l),$(l,s),$(s,k),V.block.m(k,V.anchor=null),V.mount=()=>k,V.anchor=O,$(k,O),$(k,x),$(x,E),$(l,T),$(l,M),$(M,oe),$(oe,ue);for(let Pe=0;Pe<X.length;Pe+=1)X[Pe]&&X[Pe].m(ue,null);z&&z.m(ue,null),ke=!0,fe||(Z=Le(s,"click",d[6]),fe=!0)},p(ae,[te]){d=ae,V.ctx=d,te&20&&w!==(w=d[4](+d[2]))&&fi(w,V)||So(V,d,te),(!ke||te&1&&D!==(D=`w-6 h-6 transform transition-transform duration-300 ${d[0]?"rotate-180":"rotate-0"}`))&&G(x,"class",D),te&44&&(q=ct(d[5]),Mt(),X=Ii(X,te,Y,1,d,q,ye,ue,ji,_i,null,vi),Ut(),q.length?z&&(z.d(1),z=null):z||(z=gi(),z.c(),z.m(ue,null))),(!ke||te&1&&we!==(we=`transition-max-height duration-500 ease-in-out overflow-y-scroll ${d[0]?"max-h-96":"max-h-0"}`))&&G(M,"class",we)},i(ae){if(!ke){for(let te=0;te<q.length;te+=1)xe(X[te]);ke=!0}},o(ae){for(let te=0;te<X.length;te+=1)Re(X[te]);ke=!1},d(ae){ae&&W(a),V.block.d(),V.token=null,V=null;for(let te=0;te<X.length;te+=1)X[te].d();z&&z.d(),fe=!1,Z()}}}function Vo(d,a,l){let s,k;Nt(d,To,M=>l(4,s=M)),Nt(d,Ni,M=>l(5,k=M));let w=!1,O,x,E;return on(()=>{const M=new URLSearchParams(window.location.search);l(2,x=M.get("currency")||Bi),l(1,O=Pr[x].label),l(3,E=M.get("inventory")||lt)}),[w,O,x,E,s,k,()=>l(0,w=!w),M=>Bo(M.card)]}class zo extends Et{constructor(a){super(),St(this,a,Vo,Lo,Ot,{})}}function Yo(d){let a,l,s,k,w="Clear",O,x;return{c(){a=ce("div"),l=ce("input"),s=De(),k=ce("button"),k.textContent=w,this.h()},l(E){a=le(E,"DIV",{class:!0});var D=me(a);l=le(D,"INPUT",{type:!0,placeholder:!0,class:!0}),s=Ae(D),k=le(D,"BUTTON",{class:!0,"data-svelte-h":!0}),un(k)!=="svelte-zemxuh"&&(k.textContent=w),D.forEach(W),this.h()},h(){G(l,"type","text"),G(l,"placeholder","Search..."),G(l,"class","w-1/2 p-2 border rounded-md bg-neutral-600"),G(k,"class","font-bold btn ml-4"),G(a,"class","fixed top-0 right-0 text-white p-2 flex justify-end")},m(E,D){ve(E,a,D),$(a,l),Ft(l,d[0]),$(a,s),$(a,k),O||(x=[Le(l,"input",d[1]),Le(k,"click",d[2])],O=!0)},p(E,[D]){D&1&&l.value!==E[0]&&Ft(l,E[0])},i:Ie,o:Ie,d(E){E&&W(a),O=!1,an(x)}}}function Wo(d,a,l){let{query:s=""}=a;function k(){s=this.value,l(0,s)}const w=()=>l(0,s="");return d.$$set=O=>{"query"in O&&l(0,s=O.query)},d.$$.update=()=>{d.$$.dirty&1&&qi.set(s)},[s,k,w]}class $o extends Et{constructor(a){super(),St(this,a,Wo,Yo,Ot,{query:0})}}function wi(d,a,l){const s=d.slice();return s[3]=a[l][0],s[4]=a[l][1],s}function ki(d){let a,l=d[4].label+"",s,k,w=d[4].long+"",O,x;return{c(){a=ce("option"),s=je(l),k=je(" - "),O=je(w),x=De(),this.h()},l(E){a=le(E,"OPTION",{});var D=me(a);s=Te(D,l),k=Te(D," - "),O=Te(D,w),x=Ae(D),D.forEach(W),this.h()},h(){a.__value=d[3],Ft(a,a.__value)},m(E,D){ve(E,a,D),$(a,s),$(a,k),$(a,O),$(a,x)},p:Ie,d(E){E&&W(a)}}}function Ho(d){let a,l,s="Select a currency",k,w,O=ct(Object.entries(Pr)),x=[];for(let E=0;E<O.length;E+=1)x[E]=ki(wi(d,O,E));return{c(){a=ce("select"),l=ce("option"),l.textContent=s;for(let E=0;E<x.length;E+=1)x[E].c();this.h()},l(E){a=le(E,"SELECT",{class:!0});var D=me(a);l=le(D,"OPTION",{"data-svelte-h":!0}),un(l)!=="svelte-1qzoaa8"&&(l.textContent=s);for(let T=0;T<x.length;T+=1)x[T].l(D);D.forEach(W),this.h()},h(){l.__value="",Ft(l,l.__value),l.disabled=!0,G(a,"class","rounded-md bg-neutral-600 p-2 mb-8 text-white"),d[0]===void 0&&Ki(()=>d[2].call(a))},m(E,D){ve(E,a,D),$(a,l);for(let T=0;T<x.length;T+=1)x[T]&&x[T].m(a,null);qn(a,d[0],!0),k||(w=[Le(a,"change",d[1]),Le(a,"change",d[2])],k=!0)},p(E,[D]){if(D&0){O=ct(Object.entries(Pr));let T;for(T=0;T<O.length;T+=1){const M=wi(E,O,T);x[T]?x[T].p(M,D):(x[T]=ki(M),x[T].c(),x[T].m(a,null))}for(;T<x.length;T+=1)x[T].d(1);x.length=O.length}D&1&&qn(a,E[0])},i:Ie,o:Ie,d(E){E&&W(a),Di(x,E),k=!1,an(w)}}}function Go(d,a,l){let s="20";function k(O){const x=O.target.value;l(0,s=x);const E=new URL(window.location.href);E.searchParams.set("currency",x),window.location.href=E.toString()}on(()=>{const x=new URLSearchParams(window.location.search).get("currency");x?l(0,s=x):new URL(window.location.href).searchParams.set("currency",s)});function w(){s=Ai(this),l(0,s)}return[s,k,w]}class Qo extends Et{constructor(a){super(),St(this,a,Go,Ho,Ot,{})}}function xi(d,a,l){const s=d.slice();return s[3]=a[l][0],s[4]=a[l][1],s}function Pi(d){let a,l=d[4].label+"",s,k;return{c(){a=ce("option"),s=je(l),k=De(),this.h()},l(w){a=le(w,"OPTION",{});var O=me(a);s=Te(O,l),k=Ae(O),O.forEach(W),this.h()},h(){a.__value=d[3],Ft(a,a.__value)},m(w,O){ve(w,a,O),$(a,s),$(a,k)},p:Ie,d(w){w&&W(a)}}}function Xo(d){let a,l,s="Select an inventory",k,w,O=ct(Object.entries(pi)),x=[];for(let E=0;E<O.length;E+=1)x[E]=Pi(xi(d,O,E));return{c(){a=ce("select"),l=ce("option"),l.textContent=s;for(let E=0;E<x.length;E+=1)x[E].c();this.h()},l(E){a=le(E,"SELECT",{class:!0});var D=me(a);l=le(D,"OPTION",{"data-svelte-h":!0}),un(l)!=="svelte-911blb"&&(l.textContent=s);for(let T=0;T<x.length;T+=1)x[T].l(D);D.forEach(W),this.h()},h(){l.__value="",Ft(l,l.__value),l.disabled=!0,G(a,"class","rounded-md bg-neutral-600 p-2 mb-8 text-white"),d[0]===void 0&&Ki(()=>d[2].call(a))},m(E,D){ve(E,a,D),$(a,l);for(let T=0;T<x.length;T+=1)x[T]&&x[T].m(a,null);qn(a,d[0],!0),k||(w=[Le(a,"change",d[1]),Le(a,"change",d[2])],k=!0)},p(E,[D]){if(D&0){O=ct(Object.entries(pi));let T;for(T=0;T<O.length;T+=1){const M=xi(E,O,T);x[T]?x[T].p(M,D):(x[T]=Pi(M),x[T].c(),x[T].m(a,null))}for(;T<x.length;T+=1)x[T].d(1);x.length=O.length}D&1&&qn(a,E[0])},i:Ie,o:Ie,d(E){E&&W(a),Di(x,E),k=!1,an(w)}}}function Zo(d,a,l){let s=lt;function k(O){const x=O.target.value;l(0,s=x);const E=new URL(window.location.href);E.searchParams.set("inventory",x),window.location.href=E.toString()}on(()=>{const x=new URLSearchParams(window.location.search).get("inventory");x?l(0,s=x):new URL(window.location.href).searchParams.set("inventory",s)});function w(){s=Ai(this),l(0,s)}return[s,k,w]}class Jo extends Et{constructor(a){super(),St(this,a,Zo,Xo,Ot,{})}}function Oi(d,a,l){const s=d.slice();return s[5]=a[l],s}function Ei(d){let a;return{c(){a=je("No Cards")},l(l){a=Te(l,"No Cards")},m(l,s){ve(l,a,s)},d(l){l&&W(a)}}}function Si(d){let a,l;function s(){return d[4](d[5])}return a=new Fi({props:{currency:+d[1],classid:+d[5].card.description.classid,appid:d[5].card.description.market_fee_app,count:d[5].card.count,onClick:s,showBadges:d[0]==lt}}),{c(){wt(a.$$.fragment)},l(k){kt(a.$$.fragment,k)},m(k,w){xt(a,k,w),l=!0},p(k,w){d=k;const O={};w&2&&(O.currency=+d[1]),w&4&&(O.classid=+d[5].card.description.classid),w&4&&(O.appid=d[5].card.description.market_fee_app),w&4&&(O.count=d[5].card.count),w&4&&(O.onClick=s),w&1&&(O.showBadges=d[0]==lt),a.$set(O)},i(k){l||(xe(a.$$.fragment,k),l=!0)},o(k){Re(a.$$.fragment,k),l=!1},d(k){Pt(a,k)}}}function Ci(d,a){let l,s,k,w=a[5].card.description&&Si(a);return{key:d,first:null,c(){l=Qe(),w&&w.c(),s=Qe(),this.h()},l(O){l=Qe(),w&&w.l(O),s=Qe(),this.h()},h(){this.first=l},m(O,x){ve(O,l,x),w&&w.m(O,x),ve(O,s,x),k=!0},p(O,x){a=O,a[5].card.description?w?(w.p(a,x),x&4&&xe(w,1)):(w=Si(a),w.c(),xe(w,1),w.m(s.parentNode,s)):w&&(Mt(),Re(w,1,1,()=>{w=null}),Ut())},i(O){k||(xe(w),k=!0)},o(O){Re(w),k=!1},d(O){O&&(W(l),W(s)),w&&w.d(O)}}}function ea(d){let a,l,s,k="Cards",w,O,x,E,D,T,M=[],oe=new Map,ue,X,ye,we,ke;O=new Qo({}),E=new Jo({});let fe=ct(d[2]);const Z=q=>{var Y;return(Y=q[5].card.description)==null?void 0:Y.classid};for(let q=0;q<fe.length;q+=1){let Y=Oi(d,fe,q),z=Z(Y);oe.set(z,M[q]=Ci(z,Y))}let V=null;return fe.length||(V=Ei()),X=new $o({}),we=new zo({}),{c(){a=De(),l=ce("div"),s=ce("h2"),s.textContent=k,w=De(),wt(O.$$.fragment),x=De(),wt(E.$$.fragment),D=De(),T=ce("div");for(let q=0;q<M.length;q+=1)M[q].c();V&&V.c(),ue=De(),wt(X.$$.fragment),ye=De(),wt(we.$$.fragment),this.h()},l(q){Po("svelte-1hzha9o",document.head).forEach(W),a=Ae(q),l=le(q,"DIV",{class:!0});var z=me(l);s=le(z,"H2",{class:!0,"data-svelte-h":!0}),un(s)!=="svelte-attm1z"&&(s.textContent=k),w=Ae(z),kt(O.$$.fragment,z),x=Ae(z),kt(E.$$.fragment,z),D=Ae(z),T=le(z,"DIV",{class:!0});var ae=me(T);for(let te=0;te<M.length;te+=1)M[te].l(ae);V&&V.l(ae),ae.forEach(W),z.forEach(W),ue=Ae(q),kt(X.$$.fragment,q),ye=Ae(q),kt(we.$$.fragment,q),this.h()},h(){document.title="Inventory - Technickel",G(s,"class","pb-4"),G(T,"class","flex flex-wrap justify-center gap-4"),G(l,"class","w-full h-full flex flex-col p-4")},m(q,Y){ve(q,a,Y),ve(q,l,Y),$(l,s),$(l,w),xt(O,l,null),$(l,x),xt(E,l,null),$(l,D),$(l,T);for(let z=0;z<M.length;z+=1)M[z]&&M[z].m(T,null);V&&V.m(T,null),ve(q,ue,Y),xt(X,q,Y),ve(q,ye,Y),xt(we,q,Y),ke=!0},p(q,[Y]){Y&7&&(fe=ct(q[2]),Mt(),M=Ii(M,Y,Z,1,q,fe,oe,T,ji,Ci,null,Oi),Ut(),fe.length?V&&(V.d(1),V=null):V||(V=Ei(),V.c(),V.m(T,null)))},i(q){if(!ke){xe(O.$$.fragment,q),xe(E.$$.fragment,q);for(let Y=0;Y<fe.length;Y+=1)xe(M[Y]);xe(X.$$.fragment,q),xe(we.$$.fragment,q),ke=!0}},o(q){Re(O.$$.fragment,q),Re(E.$$.fragment,q);for(let Y=0;Y<M.length;Y+=1)Re(M[Y]);Re(X.$$.fragment,q),Re(we.$$.fragment,q),ke=!1},d(q){q&&(W(a),W(l),W(ue),W(ye)),Pt(O),Pt(E);for(let Y=0;Y<M.length;Y+=1)M[Y].d();V&&V.d(),Pt(X,q),Pt(we,q)}}}function ta(d,a,l){let s;Nt(d,jo,E=>l(2,s=E));let{data:k}=a,w,O;on(()=>{const E=new URLSearchParams(window.location.search);l(1,w=E.get("currency")||Bi),l(0,O=E.get("inventory")||lt);const D=24*60*60*1e3,T=30*24*60*60*1e3;ze.prices.where("createdAt").below(Date.now()-D).delete(),ze.badges.where("createdAt").below(Date.now()-T).delete()});const x=E=>{E.card.description&&Ro(E.card)};return d.$$set=E=>{"data"in E&&l(3,k=E.data)},d.$$.update=()=>{d.$$.dirty&9&&Io(k.assets,k.descriptions,O)},[O,w,s,k,x]}class ga extends Et{constructor(a){super(),St(this,a,ta,ea,Ot,{data:3})}}export{ga as component};
