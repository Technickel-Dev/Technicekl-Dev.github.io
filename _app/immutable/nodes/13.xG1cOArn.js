import{s as te,e as T,c as y,b as S,x as R,f as b,q as w,i as W,h as v,n as j,J as se,K as q,a as A,t as oe,C as ce,g as H,d as de,O as fe,N as Q,E as Y,j as ve,r as ue,k as me}from"../chunks/scheduler.CHusSsjn.js";import{S as ne,i as le,c as k,b as F,m as z,a as Z,t as B,d as K}from"../chunks/index.D6p7BjwM.js";import{p as he}from"../chunks/stores.CphA5Xfa.js";import{r as pe,w as ge,s as _e}from"../chunks/utils.Ct5WaiD3.js";function we(l){let n,t,u='<div class="emogi svelte-6xd3vs">👾</div> <div class="emogi svelte-6xd3vs">💎</div> <div class="emogi svelte-6xd3vs">💰</div> <div class="emogi svelte-6xd3vs">🍒</div> <div class="emogi svelte-6xd3vs">🍊</div> <div class="emogi svelte-6xd3vs">🍋</div> <div class="emogi svelte-6xd3vs">🍉</div> <div class="emogi svelte-6xd3vs">🍌</div> <div class="emogi svelte-6xd3vs">🍆</div>';return{c(){n=T("div"),t=T("div"),t.innerHTML=u,this.h()},l(d){n=y(d,"DIV",{class:!0});var e=S(n);t=y(e,"DIV",{class:!0,"data-svelte-h":!0}),R(t)!=="svelte-1iz3z07"&&(t.innerHTML=u),e.forEach(b),this.h()},h(){w(t,"class","reel svelte-6xd3vs"),w(n,"class","container svelte-6xd3vs")},m(d,e){W(d,n,e),v(n,t),l[3](t)},p:j,i:j,o:j,d(d){d&&b(n),l[3](null)}}}function Me(l,n,t){let{spinOffset:u=0}=n,d=4e3+u*1e3,e;se(()=>{m()});const m=()=>{let s=e.querySelectorAll("div"),a=360/s.length,i=Math.round(s[0].offsetHeight/2/Math.tan(Math.PI/s.length));s.forEach((I,c)=>{let E=a*c;I.style.transform=`rotateX(${E}deg) translateZ(${i}px)`})},h=()=>{let s=e.querySelectorAll("div"),a=360/s.length,i=Math.round(s[0].offsetHeight/2/Math.tan(Math.PI/s.length)),I=pe(0,s.length-1),E=5+u;return new Promise(async(p,O)=>{t(0,e.style.transition=`all ${d}ms cubic-bezier(.41,-0.01,.63,1.09)`,e);let g=E*360+I*a;t(0,e.style.transform=`translateZ(${-i}px) rotateX(${-g}deg)`,e),await ge(e),t(0,e.style.transition="none",e),g=g%360,t(0,e.style.transform=`translateZ(${-i}px) rotateX(${-g}deg)`,e),p(I)})};function M(s){q[s?"unshift":"push"](()=>{e=s,t(0,e)})}return l.$$set=s=>{"spinOffset"in s&&t(1,u=s.spinOffset)},[e,u,h,M]}class J extends ne{constructor(n){super(),le(this,n,Me,we,te,{spinOffset:1,roll:2})}get roll(){return this.$$.ctx[2]}}function be(l){let n,t="",u,d,e,m,h,M,s,a,i,I,c,E,p,O,g,r,f,V='<div class="arm svelte-f4t2va"></div> <div class="ball svelte-f4t2va"></div>',L,x,D='<div class="instructions svelte-f4t2va">Type !slots to spin the wheel</div>',C,U,G,re={};i=new J({props:re}),l[7](i);let ae={spinOffset:1};c=new J({props:ae}),l[8](c);let ie={spinOffset:2};return p=new J({props:ie}),l[9](p),{c(){n=T("script"),n.innerHTML=t,d=A(),e=T("div"),m=T("div"),h=T("div"),M=oe(l[4]),s=A(),a=T("div"),k(i.$$.fragment),I=A(),k(c.$$.fragment),E=A(),k(p.$$.fragment),O=A(),g=T("div"),r=A(),f=T("div"),f.innerHTML=V,L=A(),x=T("div"),x.innerHTML=D,this.h()},l(o){const N=ce("svelte-1nbh741",document.head);n=y(N,"SCRIPT",{src:!0,"data-svelte-h":!0}),R(n)!=="svelte-i7ndq0"&&(n.innerHTML=t),N.forEach(b),d=H(o),e=y(o,"DIV",{class:!0});var _=S(e);m=y(_,"DIV",{class:!0});var $=S(m);h=y($,"DIV",{class:!0});var X=S(h);M=de(X,l[4]),X.forEach(b),$.forEach(b),s=H(_),a=y(_,"DIV",{class:!0});var P=S(a);F(i.$$.fragment,P),I=H(P),F(c.$$.fragment,P),E=H(P),F(p.$$.fragment,P),P.forEach(b),O=H(_),g=y(_,"DIV",{class:!0}),S(g).forEach(b),r=H(_),f=y(_,"DIV",{class:!0,role:!0,tabindex:!0,"data-svelte-h":!0}),R(f)!=="svelte-1chcmit"&&(f.innerHTML=V),L=H(_),x=y(_,"DIV",{class:!0,"data-svelte-h":!0}),R(x)!=="svelte-1ugn8wi"&&(x.innerHTML=D),_.forEach(b),this.h()},h(){fe(n.src,u="/tarot/tmi.min.js")||w(n,"src",u),w(h,"class","name svelte-f4t2va"),w(m,"class","semi-circle svelte-f4t2va"),w(a,"class","slots svelte-f4t2va"),Q(a,"winner",l[5]),w(g,"class","mount svelte-f4t2va"),w(f,"class","lever svelte-f4t2va"),w(f,"role","button"),w(f,"tabindex","0"),w(x,"class","console svelte-f4t2va"),w(e,"class","container svelte-f4t2va")},m(o,N){v(document.head,n),W(o,d,N),W(o,e,N),v(e,m),v(m,h),v(h,M),v(e,s),v(e,a),z(i,a,null),v(a,I),z(c,a,null),v(a,E),z(p,a,null),v(e,O),v(e,g),v(e,r),v(e,f),l[10](f),v(e,L),v(e,x),C=!0,U||(G=[Y(f,"click",l[6]),Y(f,"keypress",l[6])],U=!0)},p(o,[N]){(!C||N&16)&&ve(M,o[4]);const _={};i.$set(_);const $={};c.$set($);const X={};p.$set(X),(!C||N&32)&&Q(a,"winner",o[5])},i(o){C||(Z(i.$$.fragment,o),Z(c.$$.fragment,o),Z(p.$$.fragment,o),C=!0)},o(o){B(i.$$.fragment,o),B(c.$$.fragment,o),B(p.$$.fragment,o),C=!1},d(o){o&&(b(d),b(e)),b(n),l[7](null),K(i),l[8](null),K(c),l[9](null),K(p),l[10](null),U=!1,ue(G)}}}const ee="hello-world",Ie=2e3;function Te(l,n,t){let u;me(l,he,r=>t(12,u=r));let d,e,m,h,M,s=[],a=ee,i=!1;se(async()=>{d=u.url.searchParams.get("username"),I()});const I=()=>{const r=new window.tmi.Client({channels:[d]});r.connect(),r.on("message",(f,V,L,x)=>{let D=V["display-name"];D!==void 0&&(console.log(`${D}: ${L}`),L=="!slots"&&(s.length==0?(s.push(D),c()):s.push(D)))})},c=async()=>{const r=[{transform:"rotateX(0)"},{transform:"rotateX(180deg)"},{transform:"rotateX(0)"}],f={duration:2e3,easing:"ease-out"};M.animate(r,f),t(4,a=s[0]),a==null&&t(4,a=ee),(await Promise.all([e.roll(),m.roll(),h.roll()])).every((L,x,D)=>L===D[0])&&(t(5,i=!0),await _e(Ie),t(5,i=!1)),s.shift(),s.length>0&&c()};function E(r){q[r?"unshift":"push"](()=>{e=r,t(0,e)})}function p(r){q[r?"unshift":"push"](()=>{m=r,t(1,m)})}function O(r){q[r?"unshift":"push"](()=>{h=r,t(2,h)})}function g(r){q[r?"unshift":"push"](()=>{M=r,t(3,M)})}return[e,m,h,M,a,i,c,E,p,O,g]}class Le extends ne{constructor(n){super(),le(this,n,Te,be,te,{})}}export{Le as component};
